<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å¥½å›°ä¿±ä¹éƒ¨ - é™ªç©ç³»ç»Ÿã€å­˜å•ä¼˜åŒ–ç‰ˆã€‘</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;font-size:16px;}
        body{width:100vw;height:100vh;overflow:hidden;background:#1a1a2e;color:#fff;padding:10px;}
        .tab-box{display:flex;justify-content:space-between;margin-bottom:15px;gap:8px;}
        .tab-btn{flex:1;height:50px;line-height:50px;text-align:center;border:none;border-radius:25px;background:#16213e;font-size:16px;font-weight:bold;color:#fff;cursor:pointer;position:relative;}
        .tab-btn.active{background:#e94560;}
        .content{width:100%;height:calc(100vh - 70px);border-radius:20px;background:#16213e;padding:15px;overflow-y:auto;position:relative;z-index:1;}
        .page{display:none;}
        .page.active{display:block;}
        .btn{width:100%;height:50px;line-height:50px;border:none;border-radius:25px;background:#e94560;color:#fff;font-size:17px;font-weight:bold;margin:10px 0;cursor:pointer;}
        .btn-sm{width:48%;height:45px;line-height:45px;font-size:15px;margin:5px 0;border-radius:20px;}
        .btn-gray{background:#666;pointer-events:none;opacity:0.7;}
        .btn-green{background:#00ff9d;color:#000;}
        .btn-red{background:#ff4444;}
        .input{width:100%;height:45px;padding:0 15px;border-radius:10px;border:1px solid #333;background:#222;color:#fff;margin:8px 0;}
        .select{width:100%;height:45px;padding:0 15px;border-radius:10px;border:1px solid #333;background:#222;color:#fff;margin:8px 0;}
        .price{font-size:22px;font-weight:bold;color:#ffd700;margin:10px 0;}
        .title{font-size:18px;font-weight:bold;margin:15px 0 10px;}
        .tip{color:#ff4444;font-size:13px;margin:5px 0;}
        .tip-green{color:#00ff9d;font-size:13px;margin:5px 0;}
        .play-float-btn{position:fixed;right:15px;bottom:15px;width:60px;height:60px;border-radius:50%;background:#e94560;text-align:center;line-height:60px;font-size:22px;z-index:999;cursor:pointer;box-shadow:0 0 15px #e94560;}
        .play-float-list{position:fixed;right:15px;bottom:85px;width:280px;border-radius:15px;background:#16213e;padding:10px;z-index:998;display:none;max-height:400px;overflow-y:auto;-webkit-overflow-scrolling: touch;scrollbar-width:thin;border:2px solid #333;}
        .play-float-list::-webkit-scrollbar{width:4px;}
        .play-float-list::-webkit-scrollbar-thumb{background:#e94560;border-radius:2px;}
        .float-play-item{padding:8px;border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center;}
        .float-play-item.online{color:#00ff9d;}
        .float-play-item.offline{color:#666;opacity:0.7;}
        .float-play-item.working{color:#ff9800;}
        .float-play-item.active{background:#333;border-radius:8px;}
        .num-btn-box{display:flex;gap:8px;margin:10px 0;}
        .num-btn{width:23%;height:45px;line-height:45px;text-align:center;border-radius:10px;background:#222;border:1px solid #333;cursor:pointer;}
        .num-btn.active{background:#e94560;border:none;}
        .qrcode-box{width:100%;text-align:center;margin:10px 0;padding:10px;border-radius:10px;background:#222;}
        .qrcode{width:180px;height:180px;margin:0 auto;border-radius:10px;}
        .pay-code-box{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0;}
        .pay-code{width:48%;border-radius:10px;overflow:hidden;border:2px solid #333;}
        .pay-code img{width:100%;height:auto;}
        .chat-box{width:100%;height:220px;border:1px solid #333;border-radius:10px;padding:10px;background:#222;margin:10px 0;overflow-y:auto;}
        .chat-msg{margin:5px 0;padding:8px;border-radius:8px;max-width:80%;}
        .msg-me{background:#e94560;margin-left:auto;}
        .msg-other{background:#333;margin-right:auto;}
        .login-modal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);display:none;align-items:center;justify-content:center;z-index:1000;}
        .login-box{width:90%;padding:20px;border-radius:20px;background:#16213e;text-align:center;}
        .notify-dot{position:absolute;top:5px;right:5px;width:15px;height:15px;border-radius:50%;background:#ff4444;display:none;}
        .upload-box{width:100%;padding:20px;border:2px dashed #333;border-radius:10px;text-align:center;margin:10px 0;}
        .status-tag{padding:5px 10px;border-radius:5px;font-size:12px;display:inline-block;margin:5px 0;}
        .status-wait{background:#ff9800;color:#fff;}
        .status-ok{background:#00ff9d;color:#fff;}
        .status-no{background:#ff4444;color:#fff;}
        .order-record{padding:10px;border-radius:10px;background:#222;margin:10px 0;font-size:14px;}
        .manage-box{display:flex;gap:8px;margin:10px 0;}
        .modal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:1001;}
        .modal-content{width:90%;max-width:350px;background:#16213e;padding:20px;border-radius:15px;position:relative;}
        .modal-title{font-size:18px;font-weight:bold;margin-bottom:15px;text-align:center;}
        .modal-close{position:absolute;top:15px;right:15px;font-size:20px;cursor:pointer;color:#ff4444;}
    </style>
</head>
<body>
    <div class="login-modal" id="playLoginModal">
        <div class="login-box">
            <div class="title">ğŸ”’ é™ªç©ç™»å½•</div>
            <input type="password" class="input" id="playPwd" placeholder="è¾“å…¥å¯†ç ">
            <button class="btn" onclick="playLogin()">ç™»å½•</button>
        </div>
    </div>
    <div class="login-modal" id="adminLoginModal">
        <div class="login-box">
            <div class="title">ğŸ”‘ ç®¡ç†å‘˜ç™»å½•</div>
            <input type="password" class="input" id="adminPwd" placeholder="è¾“å…¥å¯†ç ">
            <button class="btn" onclick="adminLogin()">ç™»å½•</button>
        </div>
    </div>
    <div class="modal" id="editPlayPwdModal" style="display:none;">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('editPlayPwdModal')">Ã—</div>
            <div class="modal-title">ä¿®æ”¹é™ªç©å¯†ç </div>
            <input type="hidden" id="targetPlayPwdId">
            <div class="tip-green" id="editPlayName">å½“å‰é™ªç©ï¼šé™ªç©001</div>
            <input type="password" class="input" id="newPlayPwd" placeholder="è¾“å…¥æ–°å¯†ç ï¼ˆä¸èƒ½ä¸ºç©ºï¼‰">
            <button class="btn btn-green" onclick="savePlayPwd()">ç¡®è®¤ä¿®æ”¹</button>
            <button class="btn btn-gray" onclick="closeModal('editPlayPwdModal')" style="margin-top:8px;">å–æ¶ˆ</button>
        </div>
    </div>
    <div class="modal" id="extendPayModal" style="display:none;">
        <div class="modal-content">
            <div class="modal-close" onclick="closeModal('extendPayModal')">Ã—</div>
            <div class="modal-title">å»¶ç»­å­˜å•æ”¯ä»˜ï¼ˆ1å…ƒ/å¤©ï¼‰</div>
            <div class="tip-green">âœ… æ”¯ä»˜æˆåŠŸåï¼Œå­˜å•æœ‰æ•ˆæœŸè‡ªåŠ¨å»¶é•¿1å¤©</div>
            <div class="qrcode-box">
                <img src="https://s41.ax1x.com/2025/12/24/pZG58Y9.png" class="qrcode" alt="å¾®ä¿¡ä»˜æ¬¾">
                <div class="tip-green">å¾®ä¿¡æ‰«ç æ”¯ä»˜1å…ƒ</div>
            </div>
            <div class="tip">âš ï¸ æ”¯ä»˜åç‚¹å‡»ä¸‹æ–¹ç¡®è®¤</div>
            <button class="btn btn-green" onclick="confirmExtendPay()">å·²æ”¯ä»˜ï¼Œç¡®è®¤å»¶ç»­</button>
        </div>
    </div>

    <div class="tab-box">
        <button class="tab-btn active" onclick="switchTab('boss')">è€æ¿ç‚¹å•ç«¯</button>
        <button class="tab-btn" onclick="openPlayLogin()">é™ªç©æ¥å•ç«¯</button>
        <button class="tab-btn" onclick="openAdminLogin()">ç®¡ç†å‘˜ç«¯</button>
    </div>
    <div class="content">
        <div class="page active" id="boss">
            <div class="title">ğŸ¯ ä¿±ä¹éƒ¨è®¿é—®å…¥å£ã€æ‰«ç è¿›å¹³å°ã€‘</div>
            <div class="tip-green">âœ… æ­¤ç éä»˜æ¬¾ç ï¼Œè½¬å‘ç»™è€æ¿/é™ªç©æ‰«ç ç›´æ¥è¿›å…¥</div>
            <div class="qrcode-box">
                <img src="https://s41.ax1x.com/2025/12/24/pZG6x4f.png" class="qrcode" alt="ç³»ç»Ÿè®¿é—®äºŒç»´ç ">
                <div class="tip-green">å¥½å›°ä¿±ä¹éƒ¨ç³»ç»Ÿå…¥å£</div>
            </div>
            <div class="title">âœ… å¥½å›°ä¿±ä¹éƒ¨-é™ªç©ä»·æ ¼è¡¨</div>
            <div class="tip-green" id="activityName">ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•</div>
            <div class="tip-green">ğŸ’¡ 4é˜ŸæŠ€æœ¯å•â†’å¯¹åº”é™ªç©å…è´¹æ— é™æŒ‡å®š | æ‘¸é‡‘å•æŒ‰è§„åˆ™è®¡è´¹ | æœªæŒ‡å®šå•è‡ªåŠ¨æ´¾ç©ºé—²é™ªç©</div>
            
            <div class="title">ğŸ“± è´¦å·ç»‘å®šã€å¿…ç»‘ã€‘</div>
            <div id="bossBindBox">
                <input type="tel" class="input" id="bossPhone" placeholder="è¾“å…¥æ‰‹æœºå·ç»‘å®š">
                <button class="btn" onclick="bossBindPhone()">ç«‹å³ç»‘å®š</button>
            </div>
            <div id="bossBindSuccess" style="display:none;">
                <div class="tip-green">âœ… å·²ç»‘å®šï¼š<span id="bossBindedPhone"></span></div>
                <button class="btn btn-gray" onclick="bossUnbind()">è§£é™¤ç»‘å®š</button>
            </div>
            <div class="title">ğŸ“‹ é€‰æ‹©æœåŠ¡</div>
            <select class="select" id="serviceType" onchange="calcPrice()">
                <option value="team4_tech">4é˜ŸæŠ€æœ¯ - 4r/å±€ï¼ˆæ´»åŠ¨ä»·<span id="activePrice">2</span>rï¼‰âœ… å…è´¹æŒ‡å®š</option>
                <option value="team4_fun">4é˜Ÿå¨±ä¹ - 2.5r/å±€ | 10r/h</option>
                <option value="mojin_gucheng">æ‘¸é‡‘å¤åŸæé™ - 0.8r/å±€</option>
                <option value="mojin_kunlun">æ‘¸é‡‘æ˜†ä»‘å™©æ¢¦ - 2r/å±€</option>
                <option value="stomach_mini">èƒƒè¢‹è¿·ä½  - 3.3r/50w</option>
                <option value="stomach_small">èƒƒè¢‹å° -6.6r/100w</option>
                <option value="stomach_mid">èƒƒè¢‹ä¸­ -10r/150w</option>
                <option value="stomach_big">èƒƒè¢‹å¤§ -25r/200w</option>
            </select>
            <div class="title">ğŸ”¢ é€‰æ‹©å±€æ•°</div>
            <div class="num-btn-box">
                <div class="num-btn active" onclick="setCount(1)">1å±€</div>
                <div class="num-btn" onclick="setCount(5)">5å±€</div>
                <div class="num-btn" onclick="setCount(10)">10å±€</div>
                <div class="num-btn" onclick="setCount(20)">20å±€</div>
            </div>
            <input type="number" class="input" id="count" placeholder="è‡ªå®šä¹‰å±€æ•°ï¼ˆâ‰¥1ï¼‰" value="1" min="1" onchange="calcPrice()">
            
            <input type="checkbox" id="addGrail" onchange="calcPrice()"> <label>åœ£æ¯è¡¥è´¹+10r</label>
            <input type="checkbox" id="noGuarantee" onchange="calcPrice()"> <label>èƒƒè¢‹ä¸ä¿åº•ï¼ˆåŠ ä»·ï¼‰</label>
            <div class="price">ğŸ’° åº”ä»˜æ€»ä»·ï¼šÂ¥<span id="finalPrice">0</span></div>
            <div class="title">ğŸ’´ æ‰«ç ä»˜æ¬¾ã€çº¯ä»˜æ¬¾æ— è·³è½¬ã€‘</div>
            <div class="tip">âš ï¸ æ­¤ç ä»…ä»˜æ¬¾ï¼Œå¾®ä¿¡/æ”¯ä»˜å®æ‰«ç ç›´æ¥ä»˜æ¬¾</div>
            <div class="pay-code-box">
                <div class="pay-code">
                    <img src="https://s41.ax1x.com/2025/12/24/pZG58Y9.png" alt="å¾®ä¿¡æ”¶æ¬¾ç ">
                    <div class="tip-green">å¾®ä¿¡ä»˜æ¬¾</div>
                </div>
                <div class="pay-code">
                    <img src="https://s41.ax1x.com/2025/12/24/pZG5GWR.jpg" alt="æ”¯ä»˜å®æ”¶æ¬¾ç ">
                    <div class="tip-green">æ”¯ä»˜å®ä»˜æ¬¾</div>
                </div>
            </div>
            <div class="title">ğŸ“¸ ä¸Šä¼ ä»˜æ¬¾å‡­è¯ã€å¿…ä¼ ã€‘</div>
            <div class="upload-box" onclick="document.getElementById('payImg').click()">
                <div id="uploadTip">ç‚¹å‡»ä¸Šä¼ ä»˜æ¬¾æˆªå›¾</div>
                <div id="imgPreview" style="margin-top:10px;display:none;"></div>
                <input type="file" id="payImg" accept="image/*" style="display:none;" onchange="uploadPayImg(this)">
            </div>
            <button class="btn btn-gray" id="createOrderBtn" onclick="createOrder()">âœ… å·²ä»˜æ¬¾ï¼Œç”Ÿæˆè®¢å•å·</button>
            <div class="status-tag status-wait" id="payStatus">ä»˜æ¬¾çŠ¶æ€ï¼šå¾…ä¸Šä¼ å‡­è¯</div>
            <div class="title">ğŸ“ æˆ‘çš„è®¢å•</div>
            <div id="bossOrderRecord" class="order-record">æš‚æ— è®¢å•ï¼Œæ ¸éªŒåè‡ªåŠ¨ç”Ÿæˆ</div>
            
            <div class="title">â¸ï¸ è®¢å•å­˜å•ï¼ˆä¸­é€”æœ‰äº‹å¯æš‚åœï¼‰</div>
            <div class="tip-green">ğŸ’¡ å­˜å•æœ‰æ•ˆæœŸ7å¤©ï¼Œç¬¬6å¤©æ‰“å¼€ç³»ç»Ÿä¼šæé†’ï¼Œ1å…ƒå¯å»¶ç»­1å¤©</div>
            <button class="btn btn-green" id="createDepositBtn" onclick="createDeposit()" style="display:none;">åˆ›å»ºå­˜å•ï¼ˆæš‚åœè®¢å•ï¼‰</button>
            <button class="btn btn-green" id="extendDepositBtn" onclick="showExtendPay()" style="display:none;">å»¶ç»­å­˜å•ï¼ˆ1å…ƒ/å¤©ï¼‰</button>
            <div class="status-tag status-wait" id="depositStatus" style="display:none;"></div>
            
            <div class="title">â­ ç»“å•ç¡®è®¤+è¯„ä»·/æŠ•è¯‰</div>
            <div class="tip">âœ… é™ªç©å‘èµ·ç»“å•åï¼Œç‚¹å‡»ä¸‹æ–¹å®Œæˆç¡®è®¤+è¯„ä»·</div>
            <div style="display:flex;gap:5px;margin:10px 0;">
                <button class="btn-sm" onclick="giveScore('good')">å¥½è¯„+ç¡®è®¤ç»“å•</button>
                <button class="btn-sm" onclick="giveScore('bad')">å·®è¯„+ç¡®è®¤ç»“å•</button>
                <button class="btn-sm btn-red" onclick="giveScore('complain')">æŠ•è¯‰+1å…ƒ+ç¡®è®¤ç»“å•</button>
            </div>
            <div class="title">ğŸ’¬ è®¢å•èŠå¤©</div>
            <div class="chat-box" id="bossChat"></div>
            <input type="text" class="input" id="bossChatInput" placeholder="ç¦æ­¢å‘è”ç³»æ–¹å¼">
            <button class="btn-sm" onclick="sendBossMsg()">å‘é€</button>
        </div>
        <div class="page" id="play">
            <div class="title">ğŸ“¢ å¾…æ¥è®¢å•ã€ç®¡ç†å‘˜å®¡æ ¸åæ˜¾ç¤ºã€‘</div>
            <div id="orderList">âœ… æš‚æ— æœ‰æ•ˆè®¢å•</div>
            <button class="btn" onclick="getOrder()">åˆ·æ–°è®¢å•</button>
            
            <div class="title">â¸ï¸ æˆ‘çš„å­˜å•è®¢å•</div>
            <div id="playDepositList" class="order-record">æš‚æ— å­˜å•è®¢å•</div>
            
            <div class="title">ğŸ“± è´¦å·ç»‘å®š</div>
            <div id="playBindBox">
                <input type="tel" class="input" id="playPhone" placeholder="è¾“å…¥æ‰‹æœºå·ç»‘å®šï¼ˆæ¥å•æé†’ï¼‰">
                <button class="btn" onclick="playBindPhone()">ç«‹å³ç»‘å®š</button>
            </div>
            <div id="playBindSuccess" style="display:none;">
                <div class="tip-green">âœ… å·²ç»‘å®šï¼š<span id="playBindedPhone"></span></div>
                <button class="btn btn-gray" onclick="playUnbind()">è§£é™¤ç»‘å®š</button>
            </div>
            <div class="title">âš¡ æ¥å•çŠ¶æ€</div>
            <button class="btn btn-green" onclick="changeStatus('online')">åœ¨çº¿æ¥å•</button>
            <button class="btn btn-red" onclick="changeStatus('offline')">ç¦»çº¿ä¼‘æ¯</button>
            <div class="tip">å½“å‰çŠ¶æ€ï¼š<span class="tip-green" id="playStatus">åœ¨çº¿</span></div>
            <div class="title">ğŸ“Š å‘èµ·ç»“å•</div>
            <div class="tip-green">âœ… ä¸ŠæŠ¥åè‡ªåŠ¨å‘èµ·ç»“å•ï¼Œç­‰å¾…è€æ¿ç¡®è®¤</div>
            <input type="number" class="input" id="progressNum" placeholder="è¾“å…¥å®Œæˆå±€æ•°">
            <button class="btn btn-green" onclick="reportProgress()">âœ… å®ŒæˆæœåŠ¡ï¼Œå‘èµ·ç»“å•</button>
            <div class="title">ğŸ’´ æç°ä¸­å¿ƒ</div>
            <div>ç´¯è®¡æ”¶å…¥ï¼šÂ¥<span id="playMoney">0</span></div>
            <input type="number" class="input" id="withdrawNum" placeholder="è¾“å…¥æç°é‡‘é¢">
            <button class="btn" onclick="withdraw()">æäº¤æç°ç”³è¯·</button>
            <div class="title">ğŸ’¬ ä¸è€æ¿èŠå¤©</div>
            <div class="chat-box" id="playChat"></div>
            <input type="text" class="input" id="playChatInput" placeholder="ç¦æ­¢å‘è”ç³»æ–¹å¼">
            <button class="btn-sm" onclick="sendPlayMsg()">å‘é€</button>
        </div>
        <div class="page" id="admin">
            <div class="title">ğŸ¯ ç³»ç»Ÿè®¿é—®äºŒç»´ç ã€è½¬å‘å…¨å‘˜ã€‘</div>
            <div class="qrcode-box">
                <img src="https://s41.ax1x.com/2025/12/24/pZG6x4f.png" class="qrcode" alt="ç³»ç»Ÿè®¿é—®äºŒç»´ç ">
                <div class="tip-green">æ‰«ç è¿›å…¥ï¼Œè€æ¿/é™ªç©é€šç”¨</div>
            </div>
            <div class="title">ğŸ‘¥ é™ªç©è´¦å·ç®¡ç†ã€ä¸Šé™50äººã€‘</div>
            <div class="tip-green">âœ… ç›´æ¥æ·»åŠ /åˆ é™¤/æ”¹å¯†ç ï¼Œå®æ—¶åŒæ­¥</div>
            <input type="text" class="input" id="addPlayId" placeholder="è¾“å…¥é™ªç©è´¦å·ï¼ˆä¾‹ï¼š003ï¼‰">
            <div class="manage-box">
                <button class="btn btn-green" onclick="addPlay()">â• æ·»åŠ é™ªç©è´¦å·</button>
                <button class="btn btn-red" onclick="delPlay()">â– åˆ é™¤é€‰ä¸­é™ªç©</button>
            </div>
            <div class="tip-green">å·²æ·»åŠ ï¼š<span id="playCount">2</span>/50 äºº</div>
            <div class="order-record" id="playListShow">
                å½“å‰é™ªç©ï¼š<br>
                é™ªç©001 <button class="btn-sm btn-green" onclick="openEditPlayPwdModal('001')">æ”¹å¯†ç </button>ã€
                é™ªç©002 <button class="btn-sm btn-green" onclick="openEditPlayPwdModal('002')">æ”¹å¯†ç </button>
            </div>
            
            <div class="title">â¸ï¸ å­˜å•ç®¡ç†ä¸­å¿ƒ</div>
            <div class="tip-red">âš ï¸ å¯æŸ¥çœ‹æ‰€æœ‰å­˜å•ï¼Œå…³é—­è¿‡æœŸè®¢å•</div>
            <div id="adminDepositList" class="order-record">æš‚æ— å­˜å•è®¢å•</div>
            <button class="btn btn-red" onclick="closeExpiredDeposits()">å…³é—­æ‰€æœ‰è¿‡æœŸå­˜å•</button>
            
            <div class="title">ğŸ¡ æ´»åŠ¨å¯è§†åŒ–é…ç½®</div>
            <input type="text" class="input" id="activityInput" placeholder="è¾“å…¥æ´»åŠ¨åç§°" value="åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•">
            <input type="number" class="input" id="team4PriceInput" placeholder="4é˜ŸæŠ€æœ¯æ´»åŠ¨å•ä»·" value="2">
            <div class="manage-box">
                <button class="btn btn-green" onclick="saveActivity()">âœ… ä¿å­˜æ´»åŠ¨é…ç½®</button>
                <button class="btn btn-red" onclick="closeActivity()">âŒ å…³é—­æ´»åŠ¨</button>
            </div>
            <div class="status-tag status-ok" id="activityStatus">âœ… æ´»åŠ¨å·²å¼€å¯</div>
            <div class="title">âœ… æ ¸å¿ƒå®¡æ ¸ä¸­å¿ƒ</div>
            <div class="tip-red">âš ï¸ ä»˜æ¬¾æ ¸éªŒâ†’è®¢å•å®¡æ ¸â†’ç»“å•ç»ˆå®¡</div>
            <div id="checkAllOrder" class="order-record">æš‚æ— å¾…å®¡æ ¸ä»˜æ¬¾/è®¢å•</div>
            <div class="manage-box">
                <button class="btn btn-green" onclick="checkPayOk()">âœ… æ ¸éªŒä»˜æ¬¾æœ‰æ•ˆ</button>
                <button class="btn" onclick="agreeOrder()">âœ… åŒæ„è®¢å•</button>
                <button class="btn btn-green" onclick="finalConfirmOrder()">âœ… ç»ˆå®¡ç»“å•</button>
            </div>
            <div class="title">ğŸ’´ æ”¶æ¬¾ç ç®¡ç†</div>
            <input type="text" class="input" id="wxCode" value="https://s41.ax1x.com/2025/12/24/pZG58Y9.png">
            <input type="text" class="input" id="zfbCode" value="https://s41.ax1x.com/2025/12/24/pZG5GWR.jpg">
            <button class="btn" onclick="saveCode()">ä¿å­˜æ”¶æ¬¾ç </button>
            <div class="title">ğŸ“ˆ è¿è¥æ•°æ®çœ‹æ¿</div>
            <div class="order-record">ä»Šæ—¥è¥æ”¶ï¼šÂ¥<span id="todayMoney">0</span></div>
            <div class="order-record">ä»Šæ—¥æœ‰æ•ˆè®¢å•ï¼š<span id="todayOrder">0</span>å•</div>
            <div class="order-record">åœ¨çº¿é™ªç©ï¼š<span class="tip-green" id="activePlay">0</span>äºº | ç©ºé—²é™ªç©ï¼š<span id="idlePlay">0</span>äºº</div>
            <button class="btn" onclick="getAdminData()">åˆ·æ–°æ•°æ®</button>
            <div class="title">ğŸ’¬ ç®¡ç†å‘˜å¯¹è¯</div>
            <div class="chat-box" id="adminChat"></div>
            <input type="text" class="input" id="adminChatInput" placeholder="ä¸è€æ¿ç¡®è®¤ç»“å•äº‹å®œ">
            <button class="btn-sm" onclick="sendAdminMsg()">å‘é€</button>
            <div class="title">ğŸ”’ ç®¡ç†å‘˜å¯†ç ä¿®æ”¹</div>
            <input type="password" class="input" id="newAdminPwd" placeholder="è¾“å…¥æ–°å¯†ç ">
            <button class="btn" onclick="changeAdminPwd()">ä¿®æ”¹å¯†ç </button>
        </div>
    </div>
    <div class="play-float-btn" onclick="toggleFloatList()">ğŸ®</div>
    <div class="play-float-list" id="playFloatList"></div>

    <script>
        let currentTab = "boss", finalPrice = 0;
        let isPlayLogin = false, isAdminLogin = false, isBossBind = false;
        let currentPlayId = "", selectedPlayId = "auto", selectPlayCount = 0, playSelectPrice = 0;
        let hasUploadPayImg = false, payCheckStatus = "wait", isActivityOpen = true;
        let activePrice = 2, activityName = "ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•";
        const MAX_PLAY = 50, ADMIN_DEFAULT_PWD = "admin888";
        const forbidWords = ["åŠ å¥½å‹","ç§åŠ ","å¾®ä¿¡","QQ","å¾®â¤","ç»¿æ³¡æ³¡","V","q"];
        
        // å­˜å•æ•°æ®å­˜å‚¨ï¼ˆæœ¬åœ°å­˜å‚¨ï¼Œæ— å¤–éƒ¨ä¾èµ–ï¼‰
        let depositOrders = JSON.parse(localStorage.getItem("hk_depositOrders")) || [];
        let currentDepositId = "";

        // åˆå§‹åŒ–
        function loadData() {
            try {
                window.playList = JSON.parse(localStorage.getItem("hk_playList")) || [{pwd:"001",name:"é™ªç©001",status:"online",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""},{pwd:"002",name:"é™ªç©002",status:"offline",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""}];
                window.adminPwd = localStorage.getItem("hk_adminPwd") || ADMIN_DEFAULT_PWD;
                window.bossInfo = JSON.parse(localStorage.getItem("hk_bossInfo")) || {phone:"",deviceId:""};
                window.orderList = JSON.parse(localStorage.getItem("hk_orderList")) || [];
                window.historyOrders = JSON.parse(localStorage.getItem("hk_historyOrders")) || [];
                window.deviceId = localStorage.getItem("hk_deviceId") || Math.random().toString(36).substr(2,10);
                isActivityOpen = localStorage.getItem("hk_isActivity") === "true" || true;
                activePrice = localStorage.getItem("hk_activePrice") || 2;
                activityName = localStorage.getItem("hk_activityName") || "ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•";
                depositOrders = JSON.parse(localStorage.getItem("hk_depositOrders")) || [];
            } catch (e) {
                localStorage.clear();
                window.playList = [{pwd:"001",name:"é™ªç©001",status:"online",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""},{pwd:"002",name:"é™ªç©002",status:"offline",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""}];
                window.adminPwd = ADMIN_DEFAULT_PWD;
                window.bossInfo = {phone:"",deviceId:""};
                window.orderList = [];
                window.historyOrders = [];
                depositOrders = [];
                window.deviceId = Math.random().toString(36).substr(2,10);
                alert("âš ï¸ æœ¬åœ°æ•°æ®å¼‚å¸¸ï¼Œå·²é‡ç½®ç³»ç»Ÿï¼");
            }
            localStorage.setItem("hk_deviceId", window.deviceId);
            initFloatList();bossBindCheck();playBindCheck();calcPrice();autoPlayLogin();
            updatePlayManage();updateActivityShow();getAdminData();
            loadDepositUI();
            // å¯åŠ¨å­˜å•æé†’æ£€æŸ¥ï¼ˆæ¯åˆ†é’Ÿä¸€æ¬¡ï¼‰
            checkDepositExpire();
            setInterval(checkDepositExpire, 60000);
        }

        // ä¿å­˜æ•°æ®
        function saveData() {
            localStorage.setItem("hk_playList",JSON.stringify(window.playList));
            localStorage.setItem("hk_adminPwd",window.adminPwd);
            localStorage.setItem("hk_bossInfo",JSON.stringify(window.bossInfo));
            localStorage.setItem("hk_orderList",JSON.stringify(window.orderList));
            localStorage.setItem("hk_historyOrders",JSON.stringify(window.historyOrders));
            localStorage.setItem("hk_depositOrders",JSON.stringify(depositOrders));
            localStorage.setItem("hk_isActivity",isActivityOpen);
            localStorage.setItem("hk_activePrice",activePrice);
            localStorage.setItem("hk_activityName",activityName);
        }

        // ---------------------- åŸæœ‰åŠŸèƒ½ ----------------------
        function uploadPayImg(el) {
            if (!el.files.length) return;
            const file = el.files[0];
            const previewBox = document.getElementById("imgPreview");
            const uploadTip = document.getElementById("uploadTip");
            const allowTypes = ["image/jpeg", "image/png", "image/gif", "image/webp"];
            if (!allowTypes.includes(file.type)) {alert("âŒ ä»…æ”¯æŒ JPG/PNG/GIF/WEBP æ ¼å¼å›¾ç‰‡ï¼");el.value = "";return;}
            if (file.size > 5 * 1024 * 1024) {alert("âŒ å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MBï¼Œè¯·å‹ç¼©åä¸Šä¼ ï¼");el.value = "";return;}
            const reader = new FileReader();
            reader.onload = function(e) {
                previewBox.style.display = "block";
                previewBox.innerHTML = `<img src="${e.target.result}" style="width:120px;height:auto;border-radius:8px;">`;
                uploadTip.innerHTML = "âœ… å‡­è¯ä¸Šä¼ æˆåŠŸï¼ç­‰å¾…ç®¡ç†å‘˜æ ¸éªŒ";
                window.payImgData = e.target.result;
                hasUploadPayImg = true;
                document.getElementById("createOrderBtn").className = "btn";
                document.getElementById("payStatus").className = "status-tag status-wait";
                document.getElementById("payStatus").innerText = "ä»˜æ¬¾çŠ¶æ€ï¼šå¾…ç®¡ç†å‘˜æ ¸éªŒ";
                const bossPhone = window.bossInfo.phone || "æœªç»‘å®š";
                document.getElementById("checkAllOrder").innerHTML = `âš ï¸ æ–°ä»˜æ¬¾å¾…æ ¸éªŒ | é‡‘é¢Â¥${finalPrice} | è€æ¿æ‰‹æœºå·ï¼š${bossPhone}<br><img src="${e.target.result}" style="width:80px;height:auto;border-radius:8px;margin-top:5px;">`;
                alert("âœ… ä»˜æ¬¾å‡­è¯ä¸Šä¼ æˆåŠŸï¼Œè¯·ç­‰å¾…ç®¡ç†å‘˜æ ¸éªŒï¼");
            };
            reader.readAsDataURL(file);
            el.value = "";
        }

        function autoPlayLogin() {
            if (isPlayLogin) return;
            const play = window.playList.find(item=>item.deviceId===window.deviceId);
            if(play){isPlayLogin=true;currentPlayId=play.pwd;switchTab("play");playBindCheck();}
        }

        function withdraw(){
            const num = parseFloat(document.getElementById("withdrawNum").value);
            if(!num || num<=0){alert("âš ï¸ è¾“å…¥æœ‰æ•ˆæç°é‡‘é¢ï¼");return;}
            const play = window.playList.find(item=>item.pwd===currentPlayId);
            if(num > play.money){alert(`âš ï¸ æç°é‡‘é¢ä¸èƒ½è¶…è¿‡ä½™é¢ï¼å½“å‰ä½™é¢ï¼šÂ¥${play.money}`);return;}
            play.money -= num;
            document.getElementById("playMoney").innerText = play.money;
            saveData();
            alert(`âœ… æç°ç”³è¯·æäº¤ï¼šÂ¥${num}\nå‰©ä½™ä½™é¢ï¼šÂ¥${play.money}`);
            document.getElementById("withdrawNum").value = "";
        }

        function sendBossMsg(){
            const msg=document.getElementById("bossChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const order = window.orderList[window.orderList.length-1];
            const chatBox = document.getElementById("bossChat");
            if(order&&order.orderStatus==="å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•"){
                chatBox.innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼š${msg}</div>`;
                document.getElementById("adminChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼š${msg}</div>`;
            }else{
                chatBox.innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼š${msg}</div>`;
                document.getElementById("playChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼š${msg}</div>`;
            }
            document.getElementById("bossChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function sendPlayMsg(){
            const msg=document.getElementById("playChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const chatBox = document.getElementById("playChat");
            chatBox.innerHTML += `<div class="chat-msg msg-me">é™ªç©ï¼š${msg}</div>`;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">é™ªç©ï¼š${msg}</div>`;
            document.getElementById("playChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function sendAdminMsg(){
            const msg=document.getElementById("adminChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const chatBox = document.getElementById("adminChat");
            chatBox.innerHTML += `<div class="chat-msg msg-me">ç®¡ç†å‘˜ï¼š${msg}</div>`;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">ç®¡ç†å‘˜ï¼š${msg}</div>`;
            document.getElementById("adminChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function finalConfirmOrder(){
            const order = window.orderList[window.orderList.length-1];
            if(!order||order.orderStatus!="å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•"){alert("âš ï¸ æ— å¾…ç»ˆå®¡è®¢å•ï¼");return;}
            const play=window.playList.find(item=>item.pwd===order.playId);
            play.orderStatus = "idle";
            play.money += finalPrice;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">ç®¡ç†å‘˜ï¼šç»“å•ç»ˆå®¡é€šè¿‡ï¼é™ªç©å·²æ¢å¤ç©ºé—²</div>`;
            setTimeout(()=>{
                document.getElementById("bossChat").innerHTML = "";
                document.getElementById("playChat").innerHTML = "";
                document.getElementById("adminChat").innerHTML = "";
                window.historyOrders.push({...order, finalPrice: finalPrice});
                window.orderList.pop();
                selectedPlayId = "auto";
                saveData();
                alert("âœ… ç»“å•å®Œæˆï¼è®¢å•å½’æ¡£");
            },3000);
            initFloatList();getAdminData();saveData();
        }

        function openEditPlayPwdModal(pwd){
            const play = window.playList.find(item=>item.pwd===pwd);
            if(!play) {alert("âŒ è¯¥é™ªç©è´¦å·ä¸å­˜åœ¨ï¼");return;}
            document.getElementById("targetPlayPwdId").value = pwd;
            document.getElementById("editPlayName").innerText = `å½“å‰é™ªç©ï¼š${play.name}`;
            document.getElementById("newPlayPwd").value = "";
            document.getElementById("editPlayPwdModal").style.display = "flex";
        }

        function savePlayPwd(){
            const pwd = document.getElementById("targetPlayPwdId").value;
            const newPwd = document.getElementById("newPlayPwd").value.trim();
            if(!newPwd){alert("âš ï¸ æ–°å¯†ç ä¸èƒ½ä¸ºç©ºï¼");return;}
            const play = window.playList.find(item=>item.pwd===pwd);
            play.pwd = newPwd;
            saveData();
            updatePlayManage();
            closeModal("editPlayPwdModal");
            alert(`âœ… é™ªç©ã€${play.name}ã€‘å¯†ç ä¿®æ”¹æˆåŠŸï¼æ–°å¯†ç ï¼š${newPwd}`);
        }

        function closeModal(modalId){
            document.getElementById(modalId).style.display = "none";
        }

        function updatePlayManage(){
            document.getElementById("playCount").innerText = window.playList.length;
            let playStr = "";
            window.playList.forEach(item=>{
                playStr += `${item.name} <button class="btn-sm btn-green" onclick="openEditPlayPwdModal('${item.pwd}')">æ”¹å¯†ç </button>ã€`;
            });
            document.getElementById("playListShow").innerHTML = `å½“å‰é™ªç©ï¼š<br>${playStr.slice(0,-1)}`;
            initFloatList();
        }

        function addPlay(){
            const pwd = document.getElementById("addPlayId").value.trim();
            if(!pwd||window.playList.some(item=>item.pwd===pwd)){alert("âŒ è´¦å·ä¸ºç©ºæˆ–å·²å­˜åœ¨ï¼");return;}
            if(window.playList.length >= MAX_PLAY){alert(`âŒ å·²è¾¾é™ªç©ä¸Šé™${MAX_PLAY}äººï¼`);return;}
            const playName = prompt("è¯·è¾“å…¥é™ªç©åç§°ï¼ˆå»ºè®®åŒ…å«è´¦å·ï¼‰", `é™ªç©${pwd}`);
            if(!playName) return;
            window.playList.push({
                pwd, name: playName, status:"offline", orderStatus:"idle",
                good:0, bad:0, money:0, phone:"", deviceId:""
            });
            updatePlayManage();saveData();
            alert(`âœ… æ·»åŠ æˆåŠŸï¼š${playName}ï¼ˆè´¦å·ï¼š${pwd}ï¼‰`);
            document.getElementById("addPlayId").value = "";
        }

        function toggleFloatList(){
            const list = document.getElementById("playFloatList");
            list.style.display = list.style.display==="block"?"none":"block";
            list.scrollTop = 0;
        }

        function initFloatList() {
            const list = document.getElementById("playFloatList");
            list.innerHTML = `<div class="title" style="text-align:center;margin:0;">é™ªç©åˆ—è¡¨(${window.playList.length}/${MAX_PLAY})</div><div class="float-play-item ${selectedPlayId==='auto'?'active':''}" onclick="selectPlay('auto')">ğŸ“Œ è‡ªåŠ¨æ´¾å•ã€å…è´¹ã€‘</div>`;
            window.playList.forEach(item => {
                let cls = item.status==="online"?"online":"offline";
                cls = item.orderStatus==="working" ? "working" : cls;
                cls = item.orderStatus==="å¾…è€æ¿è¯„ä»·ç»“å•" ? "working" : cls;
                const active = selectedPlayId===item.pwd?"active":"";
                list.innerHTML += `<div class="float-play-item ${cls} ${active}" onclick="selectPlay('${item.pwd}')">${item.name}ã€${item.orderStatus==='working'?'æ¥å•ä¸­':item.status==='online'?'åœ¨çº¿':'ç¦»çº¿'}ã€‘</div>`;
            });
        }

        function selectPlay(pwd) {
            selectedPlayId = pwd;selectPlayCount++;
            const serviceType = document.getElementById("serviceType").value;
            playSelectPrice = serviceType === "team4_tech" ? 0 : (selectPlayCount>1?1:0);
            initFloatList();calcPrice();saveData();
            const play = window.playList.find(item=>item.pwd===pwd);
            alert(play ? `âœ… å·²é€‰ä¸­ï¼š${play.name}` : "âœ… å·²é€‰æ‹©ï¼šè‡ªåŠ¨æ´¾å•");
        }

        function autoDispatchOrder(order){
            const idlePlays = window.playList.filter(item=>item.status==="online" && item.orderStatus==="idle");
            if(idlePlays.length > 0){
                idlePlays.forEach(play=>{
                    play.orderStatus = "working";
                    alert(`âœ… è‡ªåŠ¨æ´¾å•æˆåŠŸï¼\nã€${play.name}ã€‘å·²æ¥å•`);
                });
                initFloatList();saveData();return true;
            }else{
                alert(`âš ï¸ å½“å‰æ— ç©ºé—²é™ªç©ï¼Œå·²åŠ å…¥æ’å•é˜Ÿåˆ—ï¼`);
                return false;
            }
        }

        function delPlay(){
            const pwd = document.getElementById("addPlayId").value.trim();
            if(!pwd||!window.playList.some(item=>item.pwd===pwd)){alert("âŒ é™ªç©è´¦å·ä¸å­˜åœ¨ï¼");return;}
            const play = window.playList.find(item=>item.pwd===pwd);
            window.playList = window.playList.filter(item=>item.pwd!==pwd);
            updatePlayManage();saveData();
            alert(`âœ… åˆ é™¤æˆåŠŸï¼š${play.name}ï¼ˆè´¦å·ï¼š${pwd}ï¼‰`);
            document.getElementById("addPlayId").value = "";
        }

        function setCount(num) {
            document.getElementById("count").value = num;
            document.querySelectorAll('.num-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.num-btn[onclick="setCount(${num})"]`).classList.add('active');
            calcPrice();
        }

        function calcPrice(){
            const type=document.getElementById("serviceType").value,count=parseInt(document.getElementById("count").value)||1;
            const addGrail=document.getElementById("addGrail").checked,noGuarantee=document.getElementById("noGuarantee").checked;
            let price=0;
            if(type==="team4_tech")price=isActivityOpen?activePrice*count:4*count;
            if(type==="team4_fun")price=2.5*count;
            if(type.includes("mojin"))price=type==="mojin_gucheng"?0.8*count:2*count;
            if(type.includes("stomach")){price=type==="stomach_mini"?3.3*count:type==="stomach_small"?6.6*count:type==="stomach_mid"?10*count:25*count;if(noGuarantee)price+=type==="stomach_small"?1.5:type==="stomach_mid"?2:5;}
            if(addGrail)price+=10;finalPrice=price+playSelectPrice;
            document.getElementById("finalPrice").innerText=finalPrice;
        }

        function createOrder(){
            if(!isBossBind){alert("âš ï¸ è¯·å…ˆç»‘å®šæ‰‹æœºå·ï¼");return;}
            if(!hasUploadPayImg){alert("âš ï¸ è¯·å…ˆä¸Šä¼ ä»˜æ¬¾å‡­è¯ï¼");return;}
            if(finalPrice<=0){alert("âš ï¸ è¯·é€‰æ‹©æœåŠ¡å’Œå±€æ•°ï¼");return;}
            if(payCheckStatus !== "ok"){alert("âš ï¸ ç®¡ç†å‘˜æœªæ ¸éªŒä»˜æ¬¾ï¼Œè¯·ç­‰å¾…ï¼");return;}
            
            const orderId = "HK-"+new Date().getTime();
            const newOrder = {id:orderId,price:finalPrice,playId:selectedPlayId,bossPhone:window.bossInfo.phone,payStatus:"å·²æ ¸éªŒ",orderStatus:"å¾…å®¡æ ¸",time:new Date().toLocaleString()};
            window.orderList.push(newOrder);
            document.getElementById("bossOrderRecord").innerHTML=`âœ… è®¢å•ç”ŸæˆæˆåŠŸï¼<br>è®¢å•å·ï¼š${orderId}<br>é‡‘é¢ï¼šÂ¥${finalPrice}<br>çŠ¶æ€ï¼šå¾…å®¡æ ¸<br>ä»˜æ¬¾çŠ¶æ€ï¼šâœ… å·²æ ¸éªŒ`;
            document.getElementById("checkAllOrder").innerHTML=`âœ… å¾…å®¡æ ¸è®¢å•ï¼š${orderId} | Â¥${finalPrice}`;
            document.getElementById("createDepositBtn").style.display = "block";
            saveData();alert(`âœ… è®¢å•å·ï¼š${orderId}\nå·²é€šçŸ¥ç®¡ç†å‘˜å®¡æ ¸ï¼`);
        }

        function checkPayOk(){
            payCheckStatus = "ok";
            document.getElementById("payStatus").className = "status-tag status-ok";
            document.getElementById("payStatus").innerText = "âœ… ä»˜æ¬¾æ ¸éªŒæœ‰æ•ˆï¼ŒçœŸå®ä»˜æ¬¾";
            document.getElementById("checkAllOrder").innerHTML = `âœ… ä»˜æ¬¾æœ‰æ•ˆ | Â¥${finalPrice} | å¯å®¡æ ¸è®¢å•`;
            alert("âœ… ä»˜æ¬¾æ ¸éªŒæˆåŠŸï¼");saveData();
        }

        function agreeOrder(){
            if(payCheckStatus !== "ok"){alert("âš ï¸ è¯·å…ˆæ ¸éªŒä»˜æ¬¾çœŸå®æ€§ï¼");return;}
            const order = window.orderList[window.orderList.length-1];
            if(!order)return;order.orderStatus = "å·²åŒæ„";
            if(selectedPlayId !== "auto"){
                const targetPlay = window.playList.find(item=>item.pwd===selectedPlayId);
                if(targetPlay){
                    targetPlay.orderStatus = "working";
                    document.getElementById("orderList").innerHTML=`âœ… æœ‰æ•ˆè®¢å•ï¼š${order.id} | Â¥${order.price}`;
                    alert(`âœ… è®¢å•å®¡æ ¸é€šè¿‡ï¼ã€${targetPlay.name}ã€‘å·²æ¥å•`);
                    targetPlay.money += finalPrice;
                }
            }else{
                autoDispatchOrder(order);
            }
            saveData();initFloatList();getAdminData();
        }

        function reportProgress(){
            const num = document.getElementById("progressNum").value;
            if(!num)alert("âš ï¸ è¾“å…¥å®Œæˆå±€æ•°ï¼");
            else{
                const play=window.playList.find(item=>item.pwd===currentPlayId);
                play.orderStatus = "å¾…è€æ¿è¯„ä»·ç»“å•";
                initFloatList();saveData();
                document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">é™ªç©ï¼šå·²å®Œæˆ${num}å±€ï¼Œè¯·è€æ¿ç¡®è®¤ç»“å•å¹¶è¯„ä»·</div>`;
                alert(`âœ… å‘èµ·ç»“å•æˆåŠŸï¼`);
            }
        }

        function giveScore(type){
            if(selectedPlayId==="auto"){alert("âš ï¸ è¯·å…ˆæŒ‡å®šé™ªç©ï¼");return;}
            const play=window.playList.find(item=>item.pwd===selectedPlayId);
            if(type==="good"){play.good++;}
            if(type==="bad"){play.bad++;}
            if(type==="complain"){if(confirm("âš ï¸ æŠ•è¯‰+1å…ƒï¼Œç¡®è®¤ï¼Ÿ")){play.bad++;finalPrice +=1;}}
            play.orderStatus = "å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•";
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼šå·²${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰'}ï¼Œç­‰å¾…ç®¡ç†å‘˜ç»ˆå®¡</div>`;
            document.getElementById("adminChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼šè®¢å•${window.orderList[window.orderList.length-1].id}ï¼Œ${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰+1å…ƒ'}</div>`;
            saveData();initFloatList();
            alert(`âœ… ${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰'}æäº¤æˆåŠŸï¼`);
        }

        function changeStatus(status){
            const play=window.playList.find(item=>item.pwd===currentPlayId);
            play.status=status;document.getElementById("playStatus").innerText=status==="online"?"åœ¨çº¿":"ç¦»çº¿";
            document.getElementById("playStatus").className=status==="online"?"tip-green":"tip";
            initFloatList();saveData();alert(`âœ… å·²åˆ‡æ¢ä¸º${status}çŠ¶æ€ï¼`);
        }

        function getAdminData(){
            document.getElementById("todayMoney").innerText=Math.floor(Math.random()*2000);
            document.getElementById("todayOrder").innerText=window.orderList.length;
            const onlineNum = window.playList.filter(item=>item.status==="online").length;
            const idleNum = window.playList.filter(item=>item.status==="online" && item.orderStatus==="idle").length;
            document.getElementById("activePlay").innerText=onlineNum;
            document.getElementById("idlePlay").innerText=idleNum;
        }

        function updateActivityShow(){
            document.getElementById("activityName").innerText=activityName;
            document.getElementById("activePrice").innerText=activePrice;
            document.getElementById("activityStatus").innerText=isActivityOpen?"âœ… æ´»åŠ¨å·²å¼€å¯":"âŒ æ´»åŠ¨å·²å…³é—­";
            document.getElementById("activityStatus").className=isActivityOpen?"status-tag status-ok":"status-tag status-no";
            calcPrice();
        }

        function saveActivity(){
            activityName = document.getElementById("activityInput").value.trim();
            activePrice = document.getElementById("team4PriceInput").value || 2;
            isActivityOpen = true;updateActivityShow();saveData();alert("âœ… æ´»åŠ¨é…ç½®ä¿å­˜æˆåŠŸï¼");
        }

        function closeActivity(){isActivityOpen = false;updateActivityShow();calcPrice();saveData();alert("âœ… æ´»åŠ¨å·²å…³é—­ï¼Œæ¢å¤åŸä»·ï¼");}

        function openPlayLogin(){document.getElementById("playLoginModal").style.display="flex";}

        function openAdminLogin(){document.getElementById("adminLoginModal").style.display="flex";}

        function playLogin() {
            const pwd = document.getElementById("playPwd").value.trim();
            const play = window.playList.find(item=>item.pwd===pwd);
            if(!play){alert("âŒ å¯†ç é”™è¯¯ï¼");return;}
            if(play.deviceId && play.deviceId!==window.deviceId){alert("âŒ è´¦å·å·²åœ¨å…¶ä»–è®¾å¤‡ç™»å½•ï¼");return;}
            isPlayLogin=true;currentPlayId=pwd;document.getElementById("playLoginModal").style.display="none";switchTab("play");playBindCheck();
        }

        function adminLogin() {
            const pwd = document.getElementById("adminPwd").value.trim();
            if(pwd!==window.adminPwd){alert("âŒ å¯†ç é”™è¯¯ï¼");return;}
            isAdminLogin=true;document.getElementById("adminLoginModal").style.display="none";switchTab("admin");
            loadAdminDepositData();
        }

        function bossBindPhone() {
            const phone = document.getElementById("bossPhone").value.trim();
            if(!/^1[3-9]\d{9}$/.test(phone)){alert("âŒ æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼");return;}
            window.bossInfo = {phone,deviceId:window.deviceId};
            document.getElementById("bossBindBox").style.display="none";
            document.getElementById("bossBindSuccess").style.display="block";
            document.getElementById("bossBindedPhone").innerText=phone;
            isBossBind=true;saveData();alert("âœ… è€æ¿ç»‘å®šæˆåŠŸï¼");
        }

        function bossBindCheck(){if(window.bossInfo.phone&&window.bossInfo.deviceId===window.deviceId){isBossBind=true;document.getElementById("bossBindBox").style.display="none";document.getElementById("bossBindSuccess").style.display="block";document.getElementById("bossBindedPhone").innerText=window.bossInfo.phone;}}

        function bossUnbind(){window.bossInfo={phone:"",deviceId:""};document.getElementById("bossBindBox").style.display="block";document.getElementById("bossBindSuccess").style.display="none";saveData();}

        function playBindPhone() {
            const phone = document.getElementById("playPhone").value.trim();
            if(!/^1[3-9]\d{9}$/.test(phone)){alert("âŒ æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼");return;}
            const play=window.playList.find(item=>item.pwd===currentPlayId);
            play.phone=phone;play.deviceId=window.deviceId;
            document.getElementById("playBindBox").style.display="none";
            document.getElementById("playBindSuccess").style.display="block";
            document.getElementById("playBindedPhone").innerText=phone;
            saveData();alert("âœ… é™ªç©ç»‘å®šæˆåŠŸï¼Œæ¥å•ä¼šæœ‰æé†’ï¼");
        }

        function playBindCheck(){const play=window.playList.find(item=>item.pwd===currentPlayId);if(play&&play.phone){document.getElementById("playBindBox").style.display="none";document.getElementById("playBindSuccess").style.display="block";document.getElementById("playBindedPhone").innerText=play.phone;}}

        function playUnbind(){const play=window.playList.find(item=>item.pwd===currentPlayId);play.phone="";play.deviceId="";document.getElementById("playBindBox").style.display="block";document.getElementById("playBindSuccess").style.display="none";saveData();}

        function switchTab(tab){
            if(tab==="play"&&!isPlayLogin){openPlayLogin();return;}if(tab==="admin"&&!isAdminLogin){openAdminLogin();return;}
            currentTab=tab;document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
            document.querySelector(`.tab-btn[onclick="${tab==='boss'?'switchTab(\'boss\')':tab==='play'?'openPlayLogin()':'openAdminLogin()'}"]`).classList.add('active');
            document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(tab).classList.add('active');
        }

        function changeAdminPwd(){const pwd=document.getElementById("newAdminPwd").value.trim();if(!pwd)alert("âš ï¸ è¾“å…¥æ–°å¯†ç ï¼");else{window.adminPwd=pwd;saveData();alert("âœ… å¯†ç ä¿®æ”¹æˆåŠŸï¼");document.getElementById("newAdminPwd").value="";}}

        function getOrder(){document.getElementById("orderList").innerHTML=window.orderList.length>0&&window.orderList[window.orderList.length-1].orderStatus==="å·²åŒæ„"?`âœ… è®¢å•ï¼š${window.orderList[window.orderList.length-1].id}`:"æš‚æ— æœ‰æ•ˆè®¢å•";}

        function saveCode(){alert("âœ… æ”¶æ¬¾ç ä¿å­˜æˆåŠŸï¼");}

        // ---------------------- å­˜å•åŠŸèƒ½ + å¾®ä¿¡é€šçŸ¥ ----------------------
        // å¾®ä¿¡æ¡Œé¢é€šçŸ¥
        function sendWechatNotify(title, content) {
            if (!("Notification" in window)) {
                return;
            }
            if (Notification.permission === "granted") {
                new Notification(title, { body: content });
            } else if (Notification.permission !== "denied") {
                Notification.requestPermission().then(permission => {
                    if (permission === "granted") {
                        new Notification(title, { body: content });
                    }
                });
            }
        }

        // åŠ è½½å­˜å•UI
        function loadDepositUI() {
            if (isBossBind) {
                const myDeposits = depositOrders.filter(item => item.bossPhone === window.bossInfo.phone);
                if (myDeposits.length > 0) {
                    currentDepositId = myDeposits[0].id;
                    document.getElementById("createDepositBtn").style.display = "none";
                    document.getElementById("extendDepositBtn").style.display = "block";
                    document.getElementById("depositStatus").style.display = "block";
                    document.getElementById("depositStatus").innerText = `âœ… æœ‰æ•ˆå­˜å•ï¼šè®¢å•${myDeposits[0].orderId}ï¼Œæœ‰æ•ˆæœŸè‡³${new Date(myDeposits[0].expireTime).toLocaleString()}`;
                }
            }
            if (isPlayLogin) {
                const myDeposits = depositOrders.filter(item => item.playId === currentPlayId);
                let html = myDeposits.length > 0 ? "" : "æš‚æ— å­˜å•è®¢å•";
                myDeposits.forEach(item => {
                    html += `ğŸ“Œ è®¢å•å·ï¼š${item.orderId}\næœ‰æ•ˆæœŸè‡³ï¼š${new Date(item.expireTime).toLocaleString()}\nå»¶ç»­æ¬¡æ•°ï¼š${item.extendCount}æ¬¡\n\n`;
                });
                document.getElementById("playDepositList").innerText = html;
            }
            if (isAdminLogin) loadAdminDepositData();
        }

        // åˆ›å»ºå­˜å•
        function createDeposit() {
            const currentOrder = window.orderList[window.orderList.length - 1];
            if (!currentOrder || currentOrder.orderStatus !== "å·²åŒæ„") {
                alert("âš ï¸ ä»…å·²åŒæ„çš„è®¢å•å¯åˆ›å»ºå­˜å•ï¼");
                return;
            }
            if (!window.bossInfo.phone) {
                alert("âš ï¸ è¯·å…ˆç»‘å®šæ‰‹æœºå·ï¼");
                return;
            }
            const hasActive = depositOrders.some(item => item.orderId === currentOrder.id && new Date(item.expireTime) > new Date());
            if (hasActive) {
                alert("âš ï¸ è¯¥è®¢å•å·²å­˜åœ¨æœ‰æ•ˆå­˜å•ï¼");
                return;
            }
            const deposit = {
                id: "DP-" + new Date().getTime(),
                orderId: currentOrder.id,
                bossPhone: window.bossInfo.phone,
                playId: currentOrder.playId,
                createTime: new Date().getTime(),
                expireTime: new Date().getTime() + 7 * 24 * 60 * 60 * 1000,
                extendCount: 0,
                status: "active",
                reminded: false
            };
            depositOrders.push(deposit);
            currentDepositId = deposit.id;
            currentOrder.orderStatus = "å­˜å•ä¸­";
            document.getElementById("createDepositBtn").style.display = "none";
            document.getElementById("extendDepositBtn").style.display = "block";
            document.getElementById("depositStatus").style.display = "block";
            document.getElementById("depositStatus").innerText = `âœ… å­˜å•åˆ›å»ºæˆåŠŸï¼æœ‰æ•ˆæœŸè‡³${new Date(deposit.expireTime).toLocaleString()}`;
            saveData();
            alert("âœ… å­˜å•åˆ›å»ºæˆåŠŸï¼ç¬¬6å¤©æ‰“å¼€ç³»ç»Ÿä¼šæ”¶åˆ°æé†’");
            loadDepositUI();
        }

        // æ˜¾ç¤ºå»¶ç»­æ”¯ä»˜å¼¹çª—
        function showExtendPay() {
            if (!currentDepositId) {
                alert("âš ï¸ æœªæ‰¾åˆ°æœ‰æ•ˆå­˜å•ï¼");
                return;
            }
            document.getElementById("extendPayModal").style.display = "flex";
        }

        // ç¡®è®¤å»¶ç»­å­˜å•
        function confirmExtendPay() {
            const deposit = depositOrders.find(item => item.id === currentDepositId);
            if (!deposit) {
                alert("âš ï¸ å­˜å•ä¸å­˜åœ¨ï¼");
                return;
            }
            deposit.expireTime += 24 * 60 * 60 * 1000;
            deposit.extendCount++;
            deposit.reminded = false;
            saveData();
            closeModal("extendPayModal");
            document.getElementById("depositStatus").innerText = `âœ… å­˜å•å»¶ç»­æˆåŠŸï¼æ–°æœ‰æ•ˆæœŸè‡³${new Date(deposit.expireTime).toLocaleString()}`;
            alert("âœ… å­˜å•å»¶ç»­æˆåŠŸï¼æœ‰æ•ˆæœŸå»¶é•¿1å¤©");
            loadDepositUI();
        }

        // å­˜å•åˆ°æœŸæé†’
        function checkDepositExpire() {
            const now = new Date().getTime();
            depositOrders.forEach(deposit => {
                if (deposit.expireTime - now <= 24 * 60 * 60 * 1000 && !deposit.reminded) {
                    sendWechatNotify("å­˜å•æé†’", `è®¢å•${deposit.orderId}å³å°†è¿‡æœŸï¼Œ1å…ƒå¯å»¶ç»­1å¤©`);
                    const remind = confirm(`âš ï¸ å­˜å•å³å°†è¿‡æœŸï¼\nè®¢å•${deposit.orderId}å­˜å•åªå‰©24å°æ—¶è¿‡æœŸï¼Œæ˜¯å¦ç«‹å³å»¶ç»­ï¼Ÿ`);
                    if (remind) {
                        showExtendPay();
                    }
                    deposit.reminded = true;
                    saveData();
                }
                if (deposit.expireTime < now && deposit.status === "active") {
                    alert(`âŒ å­˜å•å·²è¿‡æœŸï¼\nè®¢å•${deposit.orderId}å­˜å•å·²è¿‡æœŸï¼Œè®¢å•è‡ªåŠ¨å…³é—­`);
                    const order = window.orderList.find(item => item.id === deposit.orderId);
                    if (order) order.orderStatus = "å·²å…³é—­";
                    deposit.status = "expired";
                    saveData();
                }
            });
        }

        // ç®¡ç†å‘˜åŠ è½½æ‰€æœ‰å­˜å•
        function loadAdminDepositData() {
            let html = depositOrders.length > 0 ? "" : "æš‚æ— å­˜å•è®¢å•";
            depositOrders.forEach(item => {
                const status = new Date(item.expireTime) > new Date() ? "âœ… æœ‰æ•ˆ" : "âŒ å·²è¿‡æœŸ";
                html += `è®¢å•å·ï¼š${item.orderId}\nè€æ¿æ‰‹æœºå·ï¼š${item.bossPhone}\né™ªç©ï¼š${item.playId}\næœ‰æ•ˆæœŸè‡³ï¼š${new Date(item.expireTime).toLocaleString()}\nçŠ¶æ€ï¼š${status}\næ“ä½œï¼š<button class="btn-sm btn-red" onclick="closeDeposit('${item.id}')">æ‰‹åŠ¨å…³é—­</button>\n\n`;
            });
            document.getElementById("adminDepositList").innerHTML = html;
        }

        // ç®¡ç†å‘˜å…³é—­å•ä¸ªå­˜å•
        function closeDeposit(depositId) {
            const deposit = depositOrders.find(item => item.id === depositId);
            if (!deposit) return;
            const order = window.orderList.find(item => item.id === deposit.orderId);
            if (order) order.orderStatus = "å·²å…³é—­";
            depositOrders = depositOrders.filter(item => item.id !== depositId);
            saveData();
            alert("âœ… å­˜å•å·²å…³é—­ï¼");
            loadDepositUI();
        }

        // ç®¡ç†å‘˜å…³é—­æ‰€æœ‰è¿‡æœŸå­˜å•
        function closeExpiredDeposits() {
            const now = new Date().getTime();
            const expired = depositOrders.filter(item => item.expireTime < now);
            if (expired.length === 0) {
                alert("âš ï¸ æš‚æ— è¿‡æœŸå­˜å•ï¼");
                return;
            }
            expired.forEach(deposit => {
                const order = window.orderList.find(item => item.id === deposit.orderId);
                if (order) order.orderStatus = "å·²å…³é—­";
            });
            depositOrders = depositOrders.filter(item => item.expireTime >= now);
            saveData();
            alert(`âœ… å·²å…³é—­${expired.length}ä¸ªè¿‡æœŸå­˜å•ï¼`);
            loadDepositUI();
        }

        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.onload = ()=>{
            loadData();
        };
    </script>
</body>
</html>
