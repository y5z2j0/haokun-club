<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å¥½å›°ä¿±ä¹éƒ¨ - é™ªç©ç³»ç»Ÿã€ç»ˆæå®Œæ•´ç‰ˆã€‘</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:Arial, sans-serif;font-size:16px;}
        body{width:100vw;height:100vh;overflow:hidden;background:#1a1a2e;color:#fff;padding:10px;}
        .tab-box{display:flex;justify-content:space-between;margin-bottom:15px;gap:8px;}
        .tab-btn{flex:1;height:50px;line-height:50px;text-align:center;border:none;border-radius:25px;background:#16213e;font-size:16px;font-weight:bold;color:#fff;cursor:pointer;position:relative;}
        .tab-btn.active{background:#e94560;}
        .content{width:100%;height:calc(100vh - 70px);border-radius:20px;background:#16213e;padding:15px;overflow-y:auto;position:relative;z-index:1;}
        .page{display:none;}
        .page.active{display:block;}
        .btn{width:100%;height:50px;line-height:50px;border:none;border-radius:25px;background:#e94560;color:#fff;font-size:17px;font-weight:bold;margin:10px 0;cursor:pointer;}
        .btn-sm{width:48%;height:45px;line-height:45px;font-size:15px;margin:5px 0;border-radius:20px;}
        .btn-gray{background:#666;pointer-events:none;opacity:0.7;}
        .btn-green{background:#00ff9d;}
        .btn-red{background:#ff4444;}
        .input{width:100%;height:45px;padding:0 15px;border-radius:10px;border:1px solid #333;background:#222;color:#fff;margin:8px 0;}
        .select{width:100%;height:45px;padding:0 15px;border-radius:10px;border:1px solid #333;background:#222;color:#fff;margin:8px 0;}
        .price{font-size:22px;font-weight:bold;color:#ffd700;margin:10px 0;}
        .title{font-size:18px;font-weight:bold;margin:15px 0 10px;}
        .tip{color:#ff4444;font-size:13px;margin:5px 0;}
        .tip-green{color:#00ff9d;font-size:13px;margin:5px 0;}
        /* 50äººé™ªç©æ‚¬æµ®çª—-ä¸æ»‘æ»šåŠ¨ */
        .play-float-btn{position:fixed;right:15px;bottom:15px;width:60px;height:60px;border-radius:50%;background:#e94560;text-align:center;line-height:60px;font-size:22px;z-index:999;cursor:pointer;box-shadow:0 0 15px #e94560;}
        .play-float-list{position:fixed;right:15px;bottom:85px;width:280px;border-radius:15px;background:#16213e;padding:10px;z-index:998;display:none;max-height:400px;overflow-y:auto;-webkit-overflow-scrolling: touch;scrollbar-width:thin;border:2px solid #333;}
        .play-float-list::-webkit-scrollbar{width:4px;}
        .play-float-list::-webkit-scrollbar-thumb{background:#e94560;border-radius:2px;}
        .float-play-item{padding:8px;border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center;}
        .float-play-item.online{color:#00ff9d;}
        .float-play-item.offline{color:#666;opacity:0.7;}
        .float-play-item.working{color:#ff9800;}
        .float-play-item.active{background:#333;border-radius:8px;}
        /* å±€æ•°å¿«æ·é€‰æ‹© */
        .num-btn-box{display:flex;gap:8px;margin:10px 0;}
        .num-btn{width:23%;height:45px;line-height:45px;text-align:center;border-radius:10px;background:#222;border:1px solid #333;cursor:pointer;}
        .num-btn.active{background:#e94560;border:none;}
        /* äºŒç»´ç +æ”¶æ¬¾ç æ ·å¼ */
        .qrcode-box{width:100%;text-align:center;margin:10px 0;padding:10px;border-radius:10px;background:#222;}
        .qrcode{width:180px;height:180px;margin:0 auto;border-radius:10px;}
        .pay-code-box{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0;}
        .pay-code{width:48%;border-radius:10px;overflow:hidden;border:2px solid #333;}
        .pay-code img{width:100%;height:auto;}
        /* é€šç”¨æ ·å¼ */
        .chat-box{width:100%;height:220px;border:1px solid #333;border-radius:10px;padding:10px;background:#222;margin:10px 0;overflow-y:auto;}
        .chat-msg{margin:5px 0;padding:8px;border-radius:8px;max-width:80%;}
        .msg-me{background:#e94560;margin-left:auto;}
        .msg-other{background:#333;margin-right:auto;}
        .login-modal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);display:none;align-items:center;justify-content:center;z-index:1000;}
        .login-box{width:90%;padding:20px;border-radius:20px;background:#16213e;text-align:center;}
        .notify-dot{position:absolute;top:5px;right:5px;width:15px;height:15px;border-radius:50%;background:#ff4444;display:none;}
        .upload-box{width:100%;padding:20px;border:2px dashed #333;border-radius:10px;text-align:center;margin:10px 0;}
        .status-tag{padding:5px 10px;border-radius:5px;font-size:12px;display:inline-block;margin:5px 0;}
        .status-wait{background:#ff9800;color:#fff;}
        .status-ok{background:#00ff9d;color:#fff;}
        .status-no{background:#ff4444;color:#fff;}
        .order-record{padding:10px;border-radius:10px;background:#222;margin:10px 0;font-size:14px;}
        .manage-box{display:flex;gap:8px;margin:10px 0;}
        /* æ–°å¢ï¼šä¿®æ”¹å¯†ç å¼¹çª—æ ·å¼ */
        .modal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:1001;}
        .modal-content{width:90%;max-width:350px;background:#16213e;padding:20px;border-radius:15px;}
        .modal-title{font-size:18px;font-weight:bold;margin-bottom:15px;text-align:center;}
        .modal-close{position:absolute;top:15px;right:15px;font-size:20px;cursor:pointer;}
    </style>
</head>
<body>
    <!-- é™ªç©ç™»å½•å¼¹çª— -->
    <div class="login-modal" id="playLoginModal">
        <div class="login-box">
            <div class="title">ğŸ”’ é™ªç©ç™»å½•</div>
            <input type="password" class="input" id="playPwd" placeholder="è¾“å…¥å¯†ç ">
            <button class="btn" onclick="playLogin()">ç™»å½•</button>
        </div>
    </div>
    <!-- ç®¡ç†å‘˜ç™»å½•å¼¹çª— -->
    <div class="login-modal" id="adminLoginModal">
        <div class="login-box">
            <div class="title">ğŸ”‘ ç®¡ç†å‘˜ç™»å½•</div>
            <input type="password" class="input" id="adminPwd" placeholder="è¾“å…¥å¯†ç ">
            <button class="btn" onclick="adminLogin()">ç™»å½•</button>
        </div>
    </div>
    <!-- æ–°å¢ï¼šä¿®æ”¹é™ªç©å¯†ç å¼¹çª— -->
    <div class="modal" id="editPlayPwdModal">
        <div class="modal-content">
            <div class="modal-title">ä¿®æ”¹é™ªç©å¯†ç </div>
            <input type="hidden" id="targetPlayPwdId">
            <div class="tip-green" id="editPlayName"></div>
            <input type="password" class="input" id="newPlayPwd" placeholder="è¾“å…¥æ–°å¯†ç ">
            <button class="btn btn-green" onclick="savePlayPwd()">ç¡®è®¤ä¿®æ”¹</button>
            <button class="btn btn-gray" onclick="closeModal('editPlayPwdModal')">å–æ¶ˆ</button>
        </div>
    </div>

    <div class="tab-box">
        <button class="tab-btn active" onclick="switchTab('boss')">è€æ¿ç‚¹å•ç«¯</button>
        <button class="tab-btn" onclick="openPlayLogin()">é™ªç©æ¥å•ç«¯</button>
        <button class="tab-btn" onclick="openAdminLogin()">ç®¡ç†å‘˜ç«¯</button>
    </div>
    <div class="content">
        <!-- è€æ¿ç«¯ -->
        <div class="page active" id="boss">
            <div class="title">ğŸ¯ ä¿±ä¹éƒ¨è®¿é—®å…¥å£ã€æ‰«ç è¿›å¹³å°ã€‘</div>
            <div class="tip-green">âœ… æ­¤ç éä»˜æ¬¾ç ï¼Œè½¬å‘ç»™è€æ¿/é™ªç©æ‰«ç ç›´æ¥è¿›å…¥</div>
            <div class="qrcode-box">
                <img src="https://s41.ax1x.com/2025/12/24/pZG6x4f.png" class="qrcode" alt="ç³»ç»Ÿè®¿é—®äºŒç»´ç ">
                <div class="tip-green">å¥½å›°ä¿±ä¹éƒ¨ç³»ç»Ÿå…¥å£</div>
            </div>
            <div class="title">âœ… å¥½å›°ä¿±ä¹éƒ¨-é™ªç©ä»·æ ¼è¡¨</div>
            <div class="tip-green" id="activityName">ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•</div>
            <div class="tip-green">ğŸ’¡ 4é˜ŸæŠ€æœ¯å•â†’å¯¹åº”é™ªç©å…è´¹æ— é™æŒ‡å®š | æ‘¸é‡‘å•æŒ‰è§„åˆ™è®¡è´¹ | æœªæŒ‡å®šå•è‡ªåŠ¨æ´¾ç©ºé—²é™ªç©</div>
            
            <div class="title">ğŸ“± è´¦å·ç»‘å®šã€å¿…ç»‘ã€‘</div>
            <div id="bossBindBox">
                <input type="tel" class="input" id="bossPhone" placeholder="è¾“å…¥æ‰‹æœºå·ç»‘å®š">
                <button class="btn" onclick="bossBindPhone()">ç«‹å³ç»‘å®š</button>
            </div>
            <div id="bossBindSuccess" style="display:none;">
                <div class="tip-green">âœ… å·²ç»‘å®šï¼š<span id="bossBindedPhone"></span></div>
                <button class="btn btn-gray" onclick="bossUnbind()">è§£é™¤ç»‘å®š</button>
            </div>
            <div class="title">ğŸ“‹ é€‰æ‹©æœåŠ¡</div>
            <select class="select" id="serviceType" onchange="calcPrice()">
                <option value="team4_tech">4é˜ŸæŠ€æœ¯ - 4r/å±€ï¼ˆæ´»åŠ¨ä»·<span id="activePrice">2</span>rï¼‰âœ… å…è´¹æŒ‡å®š</option>
                <option value="team4_fun">4é˜Ÿå¨±ä¹ - 2.5r/å±€ | 10r/h</option>
                <option value="mojin_gucheng">æ‘¸é‡‘å¤åŸæé™ - 0.8r/å±€</option>
                <option value="mojin_kunlun">æ‘¸é‡‘æ˜†ä»‘å™©æ¢¦ - 2r/å±€</option>
                <option value="stomach_mini">èƒƒè¢‹è¿·ä½  - 3.3r/50w</option>
                <option value="stomach_small">èƒƒè¢‹å° -6.6r/100w</option>
                <option value="stomach_mid">èƒƒè¢‹ä¸­ -10r/150w</option>
                <option value="stomach_big">èƒƒè¢‹å¤§ -25r/200w</option>
            </select>
            <div class="title">ğŸ”¢ é€‰æ‹©å±€æ•°</div>
            <div class="num-btn-box">
                <div class="num-btn active" onclick="setCount(1)">1å±€</div>
                <div class="num-btn" onclick="setCount(5)">5å±€</div>
                <div class="num-btn" onclick="setCount(10)">10å±€</div>
                <div class="num-btn" onclick="setCount(20)">20å±€</div>
            </div>
            <input type="number" class="input" id="count" placeholder="è‡ªå®šä¹‰å±€æ•°ï¼ˆâ‰¥1ï¼‰" value="1" min="1" onchange="calcPrice()">
            
            <input type="checkbox" id="addGrail" onchange="calcPrice()"> <label>åœ£æ¯è¡¥è´¹+10r</label>
            <input type="checkbox" id="noGuarantee" onchange="calcPrice()"> <label>èƒƒè¢‹ä¸ä¿åº•ï¼ˆåŠ ä»·ï¼‰</label>
            <div class="price">ğŸ’° åº”ä»˜æ€»ä»·ï¼šÂ¥<span id="finalPrice">0</span></div>
            <!-- æ”¶æ¬¾ç  -->
            <div class="title">ğŸ’´ æ‰«ç ä»˜æ¬¾ã€çº¯ä»˜æ¬¾æ— è·³è½¬ã€‘</div>
            <div class="tip">âš ï¸ æ­¤ç ä»…ä»˜æ¬¾ï¼Œå¾®ä¿¡/æ”¯ä»˜å®æ‰«ç ç›´æ¥ä»˜æ¬¾</div>
            <div class="pay-code-box">
                <div class="pay-code">
                    <img src="https://s41.ax1x.com/2025/12/24/pZG58Y9.png" alt="å¾®ä¿¡æ”¶æ¬¾ç ">
                    <div class="tip-green">å¾®ä¿¡ä»˜æ¬¾</div>
                </div>
                <div class="pay-code">
                    <img src="https://s41.ax1x.com/2025/12/24/pZG5GWR.jpg" alt="æ”¯ä»˜å®æ”¶æ¬¾ç ">
                    <div class="tip-green">æ”¯ä»˜å®ä»˜æ¬¾</div>
                </div>
            </div>
            <!-- ä»˜æ¬¾å‡­è¯ä¸Šä¼ ï¼ˆä¿®å¤æ ¸å¿ƒï¼‰ -->
            <div class="title">ğŸ“¸ ä¸Šä¼ ä»˜æ¬¾å‡­è¯ã€å¿…ä¼ ã€‘</div>
            <div class="upload-box" onclick="document.getElementById('payImg').click()">
                <div id="uploadTip">ç‚¹å‡»ä¸Šä¼ ä»˜æ¬¾æˆªå›¾</div>
                <!-- æ–°å¢ï¼šé¢„è§ˆå›¾å®¹å™¨ -->
                <div id="imgPreview" style="margin-top:10px;display:none;"></div>
                <input type="file" id="payImg" accept="image/*" style="display:none;" onchange="uploadPayImg(this)">
            </div>
            <button class="btn btn-gray" id="createOrderBtn" onclick="createOrder()">âœ… å·²ä»˜æ¬¾ï¼Œç”Ÿæˆè®¢å•å·</button>
            <div class="status-tag status-wait" id="payStatus">ä»˜æ¬¾çŠ¶æ€ï¼šå¾…ä¸Šä¼ å‡­è¯</div>
            <div class="title">ğŸ“ æˆ‘çš„è®¢å•</div>
            <div id="bossOrderRecord" class="order-record">æš‚æ— è®¢å•ï¼Œæ ¸éªŒåè‡ªåŠ¨ç”Ÿæˆ</div>
            <div class="title">â­ ç»“å•ç¡®è®¤+è¯„ä»·/æŠ•è¯‰ã€æœåŠ¡å®Œæˆåæ“ä½œã€‘</div>
            <div class="tip">âœ… é™ªç©å‘èµ·ç»“å•åï¼Œç‚¹å‡»ä¸‹æ–¹å®Œæˆç¡®è®¤+è¯„ä»·ï¼Œè‡ªåŠ¨æäº¤ç®¡ç†å‘˜ç»ˆå®¡</div>
            <div style="display:flex;gap:5px;margin:10px 0;">
                <button class="btn-sm" onclick="giveScore('good')">å¥½è¯„+ç¡®è®¤ç»“å•</button>
                <button class="btn-sm" onclick="giveScore('bad')">å·®è¯„+ç¡®è®¤ç»“å•</button>
                <button class="btn-sm btn-red" onclick="giveScore('complain')">æŠ•è¯‰+1å…ƒ+ç¡®è®¤ç»“å•</button>
            </div>
            <div class="title">ğŸ’¬ è®¢å•èŠå¤©ã€ç»“å•åè‡ªåŠ¨åˆ‡æ¢ç®¡ç†å‘˜å¯¹è¯ã€‘</div>
            <div class="chat-box" id="bossChat"></div>
            <input type="text" class="input" id="bossChatInput" placeholder="ç¦æ­¢å‘è”ç³»æ–¹å¼">
            <button class="btn-sm" onclick="sendBossMsg()">å‘é€</button>
        </div>

        <!-- é™ªç©ç«¯ -->
        <div class="page" id="play">
            <div class="title">ğŸ“¢ å¾…æ¥è®¢å•ã€ç®¡ç†å‘˜å®¡æ ¸åæ˜¾ç¤ºã€‘</div>
            <div id="orderList">âœ… æš‚æ— æœ‰æ•ˆè®¢å•</div>
            <button class="btn" onclick="getOrder()">åˆ·æ–°è®¢å•</button>
            <div class="title">ğŸ“± è´¦å·ç»‘å®š</div>
            <div id="playBindBox">
                <input type="tel" class="input" id="playPhone" placeholder="è¾“å…¥æ‰‹æœºå·ç»‘å®š">
                <button class="btn" onclick="playBindPhone()">ç«‹å³ç»‘å®š</button>
            </div>
            <div id="playBindSuccess" style="display:none;">
                <div class="tip-green">âœ… å·²ç»‘å®šï¼š<span id="playBindedPhone"></span></div>
                <button class="btn btn-gray" onclick="playUnbind()">è§£é™¤ç»‘å®š</button>
            </div>
            <div class="title">âš¡ æ¥å•çŠ¶æ€ã€åœ¨çº¿/ç¦»çº¿/æ¥å•ä¸­ã€‘</div>
            <button class="btn btn-green" onclick="changeStatus('online')">åœ¨çº¿æ¥å•</button>
            <button class="btn btn-red" onclick="changeStatus('offline')">ç¦»çº¿ä¼‘æ¯</button>
            <div class="tip">å½“å‰çŠ¶æ€ï¼š<span class="tip-green" id="playStatus">åœ¨çº¿</span></div>
            <div class="title">ğŸ“Š å‘èµ·ç»“å•ã€æœåŠ¡å®Œæˆåä¸ŠæŠ¥ã€‘</div>
            <div class="tip-green">âœ… ä¸ŠæŠ¥åè‡ªåŠ¨å‘èµ·ç»“å•ï¼Œç­‰å¾…è€æ¿ç¡®è®¤+ç®¡ç†å‘˜ç»ˆå®¡ï¼Œç»ˆå®¡åè‡ªåŠ¨æ¢å¤ç©ºé—²</div>
            <input type="number" class="input" id="progressNum" placeholder="è¾“å…¥å®Œæˆå±€æ•°">
            <button class="btn btn-green" onclick="reportProgress()">âœ… å®ŒæˆæœåŠ¡ï¼Œå‘èµ·ç»“å•</button>
            <div class="title">ğŸ’´ æç°ä¸­å¿ƒï¼ˆä¿®å¤ï¼šæ‰£å‡ä½™é¢ï¼‰</div>
            <div>ç´¯è®¡æ”¶å…¥ï¼šÂ¥<span id="playMoney">0</span></div>
            <input type="number" class="input" id="withdrawNum" placeholder="è¾“å…¥æç°é‡‘é¢">
            <button class="btn" onclick="withdraw()">æäº¤æç°ç”³è¯·</button>
            <div class="title">ğŸ’¬ ä¸è€æ¿èŠå¤©ã€ç»“å•åè‡ªåŠ¨é€€å‡ºã€‘</div>
            <div class="chat-box" id="playChat"></div>
            <input type="text" class="input" id="playChatInput" placeholder="ç¦æ­¢å‘è”ç³»æ–¹å¼">
            <button class="btn-sm" onclick="sendPlayMsg()">å‘é€</button>
        </div>

        <!-- ç®¡ç†å‘˜ç«¯ï¼ˆæ–°å¢ï¼šä¿®æ”¹å¯†ç æŒ‰é’®ï¼‰ -->
        <div class="page" id="admin">
            <div class="title">ğŸ¯ ç³»ç»Ÿè®¿é—®äºŒç»´ç ã€è½¬å‘å…¨å‘˜ã€‘</div>
            <div class="qrcode-box">
                <img src="https://s41.ax1x.com/2025/12/24/pZG6x4f.png" class="qrcode" alt="ç³»ç»Ÿè®¿é—®äºŒç»´ç ">
                <div class="tip-green">æ‰«ç è¿›å…¥ï¼Œè€æ¿/é™ªç©é€šç”¨</div>
            </div>
            <div class="title">ğŸ‘¥ é™ªç©è´¦å·ç®¡ç†ã€ä¸Šé™50äººï¼Œæ”¯æŒæ”¹å¯†ç ã€‘</div>
            <div class="tip-green">âœ… ç›´æ¥æ·»åŠ /åˆ é™¤/æ”¹å¯†ç ï¼Œå®æ—¶åŒæ­¥æ‚¬æµ®çª—ï¼Œæ— éœ€æ”¹ä»£ç </div>
            <input type="text" class="input" id="addPlayId" placeholder="è¾“å…¥é™ªç©è´¦å·ï¼ˆä¾‹ï¼š003/004ï¼‰">
            <div class="manage-box">
                <button class="btn btn-green" onclick="addPlay()">â• æ·»åŠ é™ªç©è´¦å·</button>
                <button class="btn btn-red" onclick="delPlay()">â– åˆ é™¤é€‰ä¸­é™ªç©</button>
            </div>
            <div class="tip-green">å·²æ·»åŠ ï¼š<span id="playCount">2</span>/50 äºº</div>
            <!-- ä¿®å¤ï¼šé™ªç©åˆ—è¡¨æ˜¾ç¤ºä¿®æ”¹å¯†ç æŒ‰é’® -->
            <div class="order-record" id="playListShow">
                å½“å‰é™ªç©ï¼š<br>
                001ï¼ˆ<button class="btn-sm btn-green" onclick="openEditPlayPwdModal('001')">æ”¹å¯†ç </button>ï¼‰ã€
                002ï¼ˆ<button class="btn-sm btn-green" onclick="openEditPlayPwdModal('002')">æ”¹å¯†ç </button>ï¼‰
            </div>
            <div class="title">ğŸ¡ æ´»åŠ¨å¯è§†åŒ–é…ç½®ã€æ— éœ€æ”¹ä»£ç ï¼Œä¸€é”®ç”Ÿæ•ˆã€‘</div>
            <input type="text" class="input" id="activityInput" placeholder="è¾“å…¥æ´»åŠ¨åç§°" value="åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•">
            <input type="number" class="input" id="team4PriceInput" placeholder="4é˜ŸæŠ€æœ¯æ´»åŠ¨å•ä»·" value="2">
            <div class="manage-box">
                <button class="btn btn-green" onclick="saveActivity()">âœ… ä¿å­˜æ´»åŠ¨é…ç½®</button>
                <button class="btn btn-red" onclick="closeActivity()">âŒ å…³é—­æ´»åŠ¨ï¼ˆæ¢å¤åŸä»·ï¼‰</button>
            </div>
            <div class="status-tag status-ok" id="activityStatus">âœ… æ´»åŠ¨å·²å¼€å¯</div>
            <div class="title">âœ… æ ¸å¿ƒå®¡æ ¸ä¸­å¿ƒã€ä»˜æ¬¾æ ¸éªŒ+è®¢å•å®¡æ ¸+ç»“å•ç»ˆå®¡ã€‘</div>
            <div class="tip-red">âš ï¸ ä»˜æ¬¾æ ¸éªŒâ†’è®¢å•å®¡æ ¸â†’ç»“å•ç»ˆå®¡ï¼Œä¸‰æ­¥é—­ç¯ï¼Œå…¨ç¨‹å¯æ§</div>
            <div id="checkAllOrder" class="order-record">æš‚æ— å¾…å®¡æ ¸ä»˜æ¬¾/è®¢å•</div>
            <div class="manage-box">
                <button class="btn btn-green" onclick="checkPayOk()">âœ… æ ¸éªŒä»˜æ¬¾æœ‰æ•ˆ</button>
                <button class="btn" onclick="agreeOrder()">âœ… åŒæ„è®¢å•ï¼ˆé™ªç©å¯æ¥ï¼‰</button>
                <button class="btn btn-green" onclick="finalConfirmOrder()">âœ… ç»ˆå®¡ç»“å•ï¼ˆæ¢å¤ç©ºé—²+é”€æ¯èŠå¤©ï¼‰</button>
            </div>
            <div class="title">ğŸ’´ æ”¶æ¬¾ç ç®¡ç†</div>
            <input type="text" class="input" id="wxCode" value="https://s41.ax1x.com/2025/12/24/pZG58Y9.png">
            <input type="text" class="input" id="zfbCode" value="https://s41.ax1x.com/2025/12/24/pZG5GWR.jpg">
            <button class="btn" onclick="saveCode()">ä¿å­˜æ”¶æ¬¾ç </button>
            <div class="title">ğŸ“ˆ è¿è¥æ•°æ®çœ‹æ¿</div>
            <div class="order-record">ä»Šæ—¥è¥æ”¶ï¼šÂ¥<span id="todayMoney">0</span></div>
            <div class="order-record">ä»Šæ—¥æœ‰æ•ˆè®¢å•ï¼š<span id="todayOrder">0</span>å•</div>
            <div class="order-record">åœ¨çº¿é™ªç©ï¼š<span class="tip-green" id="activePlay">0</span>äºº | ç©ºé—²é™ªç©ï¼š<span id="idlePlay">0</span>äºº</div>
            <button class="btn" onclick="getAdminData()">åˆ·æ–°æ•°æ®</button>
            <div class="title">ğŸ’¬ ç®¡ç†å‘˜å¯¹è¯ã€ç»“å•åè‡ªåŠ¨æ¥å…¥è€æ¿ã€‘</div>
            <div class="chat-box" id="adminChat"></div>
            <input type="text" class="input" id="adminChatInput" placeholder="ä¸è€æ¿ç¡®è®¤ç»“å•äº‹å®œ">
            <button class="btn-sm" onclick="sendAdminMsg()">å‘é€</button>
            <div class="title">ğŸ”’ ç®¡ç†å‘˜å¯†ç ä¿®æ”¹</div>
            <input type="password" class="input" id="newAdminPwd" placeholder="è¾“å…¥æ–°å¯†ç ">
            <button class="btn" onclick="changeAdminPwd()">ä¿®æ”¹å¯†ç </button>
        </div>
    </div>
    <div class="play-float-btn" onclick="toggleFloatList()">ğŸ®</div>
    <div class="play-float-list" id="playFloatList"></div>

    <script>
        let currentTab = "boss", finalPrice = 0;
        let isPlayLogin = false, isAdminLogin = false, isBossBind = false;
        let currentPlayId = "", selectedPlayId = "auto", selectPlayCount = 0, playSelectPrice = 0;
        let hasUploadPayImg = false, payCheckStatus = "wait", isActivityOpen = true;
        let activePrice = 2, activityName = "ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•";
        const MAX_PLAY = 50, ADMIN_DEFAULT_PWD = "admin888";
        const forbidWords = ["åŠ å¥½å‹","ç§åŠ ","å¾®ä¿¡","QQ","å¾®â¤","ç»¿æ³¡æ³¡","V","q"];

        // åˆå§‹åŒ–
        function loadData() {
            try {
                // ä¿®å¤ï¼šæœ¬åœ°å­˜å‚¨è§£æå®¹é”™
                window.playList = JSON.parse(localStorage.getItem("hk_playList")) || [{pwd:"001",name:"é™ªç©001",status:"online",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""},{pwd:"002",name:"é™ªç©002",status:"offline",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""}];
                window.adminPwd = localStorage.getItem("hk_adminPwd") || ADMIN_DEFAULT_PWD;
                window.bossInfo = JSON.parse(localStorage.getItem("hk_bossInfo")) || {phone:"",deviceId:""};
                window.orderList = JSON.parse(localStorage.getItem("hk_orderList")) || [];
                window.historyOrders = JSON.parse(localStorage.getItem("hk_historyOrders")) || [];
                window.deviceId = localStorage.getItem("hk_deviceId") || Math.random().toString(36).substr(2,10);
                isActivityOpen = localStorage.getItem("hk_isActivity") === "true" || true;
                activePrice = localStorage.getItem("hk_activePrice") || 2;
                activityName = localStorage.getItem("hk_activityName") || "ğŸ„åœ£è¯ç‰¹æƒ ï¼š4é˜ŸæŠ€æœ¯2r/å±€ï¼Œæ— å°æ—¶å•";
            } catch (e) {
                // æ•°æ®æŸåæ—¶é‡ç½®
                localStorage.clear();
                window.playList = [{pwd:"001",name:"é™ªç©001",status:"online",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""},{pwd:"002",name:"é™ªç©002",status:"offline",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""}];
                window.adminPwd = ADMIN_DEFAULT_PWD;
                window.bossInfo = {phone:"",deviceId:""};
                window.orderList = [];
                window.historyOrders = [];
                window.deviceId = Math.random().toString(36).substr(2,10);
                alert("âš ï¸ æœ¬åœ°æ•°æ®å¼‚å¸¸ï¼Œå·²é‡ç½®ç³»ç»Ÿï¼");
            }
            localStorage.setItem("hk_deviceId", window.deviceId);
            initFloatList();bossBindCheck();playBindCheck();calcPrice();autoPlayLogin();
            updatePlayManage();updateActivityShow();getAdminData();
        }

        function saveData() {
            localStorage.setItem("hk_playList",JSON.stringify(window.playList));
            localStorage.setItem("hk_adminPwd",window.adminPwd);
            localStorage.setItem("hk_bossInfo",JSON.stringify(window.bossInfo));
            localStorage.setItem("hk_orderList",JSON.stringify(window.orderList));
            localStorage.setItem("hk_historyOrders",JSON.stringify(window.historyOrders));
            localStorage.setItem("hk_isActivity",isActivityOpen);
            localStorage.setItem("hk_activePrice",activePrice);
            localStorage.setItem("hk_activityName",activityName);
        }

        // 1. ä¿®å¤ï¼šä»˜æ¬¾å‡­è¯ä¸Šä¼ æ— ååº”ï¼ˆæ ¸å¿ƒä¿®æ”¹ï¼‰
        function uploadPayImg(el) {
            if (!el.files.length) return;
            const file = el.files[0];
            const previewBox = document.getElementById("imgPreview");
            const uploadTip = document.getElementById("uploadTip");
            
            // æ ¡éªŒæ–‡ä»¶ç±»å‹ï¼ˆä»…å›¾ç‰‡ï¼‰
            const allowTypes = ["image/jpeg", "image/png", "image/gif", "image/webp"];
            if (!allowTypes.includes(file.type)) {
                alert("âŒ ä»…æ”¯æŒ JPG/PNG/GIF/WEBP æ ¼å¼å›¾ç‰‡ï¼");
                el.value = "";
                return;
            }

            // æ ¡éªŒæ–‡ä»¶å¤§å°ï¼ˆâ‰¤5MBï¼‰
            if (file.size > 5 * 1024 * 1024) {
                alert("âŒ å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MBï¼Œè¯·å‹ç¼©åä¸Šä¼ ï¼");
                el.value = "";
                return;
            }

            // é¢„è§ˆå›¾ç‰‡ï¼ˆè®©ç”¨æˆ·ç¡®è®¤ä¸Šä¼ æˆåŠŸï¼‰
            const reader = new FileReader();
            reader.onload = function(e) {
                previewBox.style.display = "block";
                previewBox.innerHTML = `<img src="${e.target.result}" style="width:120px;height:auto;border-radius:8px;">`;
                uploadTip.innerHTML = "âœ… å‡­è¯ä¸Šä¼ æˆåŠŸï¼ç­‰å¾…ç®¡ç†å‘˜æ ¸éªŒ";
                
                // ä¿å­˜å›¾ç‰‡æ•°æ®åˆ°æœ¬åœ°ï¼ˆç”¨äºæ ¸éªŒï¼‰
                window.payImgData = e.target.result;
                hasUploadPayImg = true;
                
                // æ¿€æ´»ç”Ÿæˆè®¢å•æŒ‰é’®
                document.getElementById("createOrderBtn").className = "btn";
                document.getElementById("payStatus").className = "status-tag status-wait";
                document.getElementById("payStatus").innerText = "ä»˜æ¬¾çŠ¶æ€ï¼šå¾…ç®¡ç†å‘˜æ ¸éªŒ";
                
                // åŒæ­¥åˆ°ç®¡ç†å‘˜å®¡æ ¸ä¸­å¿ƒï¼ˆæ˜¾ç¤ºé¢„è§ˆï¼‰
                const bossPhone = window.bossInfo.phone || "æœªç»‘å®š";
                document.getElementById("checkAllOrder").innerHTML = `âš ï¸ æ–°ä»˜æ¬¾å¾…æ ¸éªŒ | é‡‘é¢Â¥${finalPrice} | è€æ¿æ‰‹æœºå·ï¼š${bossPhone}<br><img src="${e.target.result}" style="width:80px;height:auto;border-radius:8px;margin-top:5px;">`;
                alert("âœ… ä»˜æ¬¾å‡­è¯ä¸Šä¼ æˆåŠŸï¼Œè¯·ç­‰å¾…ç®¡ç†å‘˜æ ¸éªŒï¼");
            };
            reader.readAsDataURL(file);
            el.value = ""; // é‡ç½®è¾“å…¥ï¼Œå…è®¸é‡å¤ä¸Šä¼ 
        }

        // 2. ä¿®å¤ï¼šé™ªç©è‡ªåŠ¨ç™»å½•é‡å¤è§¦å‘
        function autoPlayLogin() {
            if (isPlayLogin) return; // å·²ç™»å½•åˆ™è·³è¿‡
            const play = window.playList.find(item=>item.deviceId===window.deviceId);
            if(play){
                isPlayLogin=true;
                currentPlayId=play.pwd;
                switchTab("play");
                playBindCheck();
            }
        }

        // 3. ä¿®å¤ï¼šæç°åŠŸèƒ½æ— ä½™é¢æ‰£å‡
        function withdraw(){
            const num = parseFloat(document.getElementById("withdrawNum").value);
            if(!num || num<=0){
                alert("âš ï¸ è¾“å…¥æœ‰æ•ˆæç°é‡‘é¢ï¼");
                return;
            }
            const play = window.playList.find(item=>item.pwd===currentPlayId);
            if(num > play.money){
                alert(`âš ï¸ æç°é‡‘é¢ä¸èƒ½è¶…è¿‡ä½™é¢ï¼å½“å‰ä½™é¢ï¼šÂ¥${play.money}`);
                return;
            }
            // æ‰£å‡ä½™é¢
            play.money -= num;
            document.getElementById("playMoney").innerText = play.money;
            saveData();
            alert(`âœ… æç°ç”³è¯·æäº¤ï¼šÂ¥${num}\nå‰©ä½™ä½™é¢ï¼šÂ¥${play.money}`);
            document.getElementById("withdrawNum").value = "";
        }

        // 4. ä¿®å¤ï¼šèŠå¤©ç³»ç»Ÿæœªæ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
        function sendBossMsg(){
            const msg=document.getElementById("bossChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const order = window.orderList[window.orderList.length-1];
            const chatBox = document.getElementById("bossChat");
            
            if(order&&order.orderStatus==="å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•"){
                chatBox.innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼š${msg}</div>`;
                document.getElementById("adminChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼š${msg}</div>`;
            }else{
                chatBox.innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼š${msg}</div>`;
                document.getElementById("playChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼š${msg}</div>`;
            }
            document.getElementById("bossChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight; // æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
        }
        function sendPlayMsg(){
            const msg=document.getElementById("playChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const chatBox = document.getElementById("playChat");
            chatBox.innerHTML += `<div class="chat-msg msg-me">é™ªç©ï¼š${msg}</div>`;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">é™ªç©ï¼š${msg}</div>`;
            document.getElementById("playChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }
        function sendAdminMsg(){
            const msg=document.getElementById("adminChatInput").value.trim();
            if(!msg||forbidWords.some(w=>msg.includes(w))){alert("âŒ è¿è§„å†…å®¹ï¼");return;}
            const chatBox = document.getElementById("adminChat");
            chatBox.innerHTML += `<div class="chat-msg msg-me">ç®¡ç†å‘˜ï¼š${msg}</div>`;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">ç®¡ç†å‘˜ï¼š${msg}</div>`;
            document.getElementById("adminChatInput").value = "";
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // 5. ä¿®å¤ï¼šç®¡ç†å‘˜ç»ˆå®¡ç»“å•æœªé‡ç½®é€‰ä¸­é™ªç©
        function finalConfirmOrder(){
            const order = window.orderList[window.orderList.length-1];
            if(!order||order.orderStatus!="å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•"){alert("âš ï¸ æ— å¾…ç»ˆå®¡è®¢å•ï¼");return;}
            
            const play=window.playList.find(item=>item.pwd===order.playId);
            play.orderStatus = "idle";
            play.money += finalPrice;
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">ç®¡ç†å‘˜ï¼šç»“å•ç»ˆå®¡é€šè¿‡ï¼é™ªç©å·²æ¢å¤ç©ºé—²ï¼ŒèŠå¤©å³å°†å…³é—­</div>`;
            
            setTimeout(()=>{
                document.getElementById("bossChat").innerHTML = "";
                document.getElementById("playChat").innerHTML = "";
                document.getElementById("adminChat").innerHTML = "";
                
                window.historyOrders.push({...order, finalPrice: finalPrice});
                window.orderList.pop();
                selectedPlayId = "auto"; // é‡ç½®é€‰ä¸­é™ªç©
                saveData();
                alert("âœ… ç»“å•å®Œæˆï¼\né™ªç©æ¢å¤ç©ºé—²+èŠå¤©é”€æ¯+è®¢å•å½’æ¡£");
            },3000);
            initFloatList();getAdminData();saveData();
        }

        // 6. æ–°å¢ï¼šé™ªç©å¯†ç ä¿®æ”¹åŠŸèƒ½ï¼ˆç®¡ç†å‘˜ç«¯ï¼‰
        function openEditPlayPwdModal(pwd){
            const play = window.playList.find(item=>item.pwd===pwd);
            if(!play) return;
            document.getElementById("targetPlayPwdId").value = pwd;
            document.getElementById("editPlayName").innerText = `å½“å‰é™ªç©ï¼š${play.name}`;
            document.getElementById("newPlayPwd").value = "";
            document.getElementById("editPlayPwdModal").style.display = "flex";
        }
        function savePlayPwd(){
            const pwd = document.getElementById("targetPlayPwdId").value;
            const newPwd = document.getElementById("newPlayPwd").value.trim();
            if(!newPwd){alert("âš ï¸ æ–°å¯†ç ä¸èƒ½ä¸ºç©ºï¼");return;}
            const play = window.playList.find(item=>item.pwd===pwd);
            play.pwd = newPwd; // æ›´æ–°å¯†ç 
            saveData();
            updatePlayManage(); // åˆ·æ–°é™ªç©åˆ—è¡¨
            closeModal("editPlayPwdModal");
            alert(`âœ… é™ªç©${play.name}å¯†ç ä¿®æ”¹æˆåŠŸï¼æ–°å¯†ç ï¼š${newPwd}`);
        }
        function closeModal(modalId){
            document.getElementById(modalId).style.display = "none";
        }

        // 7. ä¿®å¤ï¼šé™ªç©åˆ—è¡¨æ˜¾ç¤ºï¼ˆå«ä¿®æ”¹å¯†ç æŒ‰é’®ï¼‰
        function updatePlayManage(){
            document.getElementById("playCount").innerText = window.playList.length;
            let playStr = "";
            window.playList.forEach(item=>{
                playStr += `${item.pwd}ï¼ˆ<button class="btn-sm btn-green" onclick="openEditPlayPwdModal('${item.pwd}')">æ”¹å¯†ç </button>ï¼‰ã€`;
            });
            document.getElementById("playListShow").innerText = `å½“å‰é™ªç©ï¼š${playStr.slice(0,-1)}`;
            initFloatList();
        }

        // åŸæœ‰åŠŸèƒ½ä¿ç•™ï¼ˆæœªä¿®æ”¹éƒ¨åˆ†ï¼‰
        function toggleFloatList(){
            const list = document.getElementById("playFloatList");
            list.style.display = list.style.display==="block"?"none":"block";
            list.scrollTop = 0;
        }
        function initFloatList() {
            const list = document.getElementById("playFloatList");
            list.innerHTML = `<div class="title" style="text-align:center;margin:0;">é™ªç©åˆ—è¡¨(${window.playList.length}/${MAX_PLAY})</div><div class="float-play-item ${selectedPlayId==='auto'?'active':''}" onclick="selectPlay('auto')">ğŸ“Œ è‡ªåŠ¨æ´¾å•ã€å…è´¹ã€‘</div>`;
            window.playList.forEach(item => {
                let cls = item.status==="online"?"online":"offline";
                cls = item.orderStatus==="working" ? "working" : cls;
                cls = item.orderStatus==="å¾…è€æ¿è¯„ä»·ç»“å•" ? "working" : cls;
                const active = selectedPlayId===item.pwd?"active":"";
                list.innerHTML += `<div class="float-play-item ${cls} ${active}" onclick="selectPlay('${item.pwd}')">${item.name}ã€${item.orderStatus==='working'?'æ¥å•ä¸­':item.status==='online'?'åœ¨çº¿':'ç¦»çº¿'}ã€‘</div>`;
            });
        }
        function selectPlay(pwd) {
            selectedPlayId = pwd;selectPlayCount++;
            const serviceType = document.getElementById("serviceType").value;
            playSelectPrice = serviceType === "team4_tech" ? 0 : (selectPlayCount>1?1:0);
            initFloatList();calcPrice();saveData();
            // æ–°å¢é€‰ä¸­æç¤º
            const play = window.playList.find(item=>item.pwd===pwd);
            alert(play ? `âœ… å·²é€‰ä¸­ï¼š${play.name}` : "âœ… å·²é€‰æ‹©ï¼šè‡ªåŠ¨æ´¾å•");
        }
        function autoDispatchOrder(order){
            const idlePlays = window.playList.filter(item=>item.status==="online" && item.orderStatus==="idle");
            if(idlePlays.length > 0){
                idlePlays.forEach(play=>{
                    play.orderStatus = "working";
                    alert(`âœ… è‡ªåŠ¨æ´¾å•æˆåŠŸï¼\nã€${play.name}ã€‘å·²æ¥å•ï¼Œè®¢å•å·ï¼š${order.id}`);
                });
                initFloatList();saveData();return true;
            }else{
                alert(`âš ï¸ å½“å‰æ— ç©ºé—²é™ªç©ï¼Œå·²åŠ å…¥æ’å•é˜Ÿåˆ—ï¼\nè®¢å•å·ï¼š${order.id}`);
                return false;
            }
        }
        function addPlay(){
            const pwd = document.getElementById("addPlayId").value.trim();
            if(!pwd||window.playList.some(item=>item.pwd===pwd)){alert("è´¦å·ä¸ºç©º/å·²å­˜åœ¨ï¼");return;}
            if(window.playList.length >= MAX_PLAY){alert(`å·²è¾¾ä¸Šé™${MAX_PLAY}äººï¼`);return;}
            window.playList.push({pwd,name:`é™ªç©${pwd}`,status:"offline",orderStatus:"idle",good:0,bad:0,money:0,phone:"",deviceId:""});
            updatePlayManage();saveData();alert(`âœ… æ·»åŠ æˆåŠŸï¼š${pwd}`);
            document.getElementById("addPlayId").value = "";
        }
        function delPlay(){
            const pwd = document.getElementById("addPlayId").value.trim();
            if(!pwd||!window.playList.some(item=>item.pwd===pwd)){alert("è´¦å·ä¸å­˜åœ¨ï¼");return;}
            window.playList = window.playList.filter(item=>item.pwd!==pwd);
            updatePlayManage();saveData();alert(`âœ… åˆ é™¤æˆåŠŸï¼š${pwd}`);
            document.getElementById("addPlayId").value = "";
        }
        function setCount(num) {
            document.getElementById("count").value = num;
            document.querySelectorAll('.num-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.num-btn[onclick="setCount(${num})"]`).classList.add('active');
            calcPrice();
        }
        function calcPrice(){
            const type=document.getElementById("serviceType").value,count=parseInt(document.getElementById("count").value)||1;
            const addGrail=document.getElementById("addGrail").checked,noGuarantee=document.getElementById("noGuarantee").checked;
            let price=0;
            if(type==="team4_tech")price=isActivityOpen?activePrice*count:4*count;
            if(type==="team4_fun")price=2.5*count;
            if(type.includes("mojin"))price=type==="mojin_gucheng"?0.8*count:2*count;
            if(type.includes("stomach")){price=type==="stomach_mini"?3.3*count:type==="stomach_small"?6.6*count:type==="stomach_mid"?10*count:25*count;if(noGuarantee)price+=type==="stomach_small"?1.5:type==="stomach_mid"?2:5;}
            if(addGrail)price+=10;finalPrice=price+playSelectPrice;
            document.getElementById("finalPrice").innerText=finalPrice;
        }
        function createOrder(){
            if(!isBossBind){alert("âš ï¸ è¯·å…ˆç»‘å®šæ‰‹æœºå·ï¼");return;}
            if(!hasUploadPayImg){alert("âš ï¸ è¯·å…ˆä¸Šä¼ ä»˜æ¬¾å‡­è¯ï¼");return;}
            if(finalPrice<=0){alert("âš ï¸ è¯·é€‰æ‹©æœåŠ¡å’Œå±€æ•°ï¼");return;}
            if(payCheckStatus !== "ok"){alert("âš ï¸ ç®¡ç†å‘˜æœªæ ¸éªŒä»˜æ¬¾ï¼Œè¯·ç­‰å¾…ï¼");return;}
            
            const orderId = "HK-"+new Date().getTime();
            const newOrder = {id:orderId,price:finalPrice,playId:selectedPlayId,bossPhone:window.bossInfo.phone,payStatus:"å·²æ ¸éªŒ",orderStatus:"å¾…å®¡æ ¸",time:new Date().toLocaleString()};
            window.orderList.push(newOrder);
            document.getElementById("bossOrderRecord").innerHTML=`âœ… è®¢å•ç”ŸæˆæˆåŠŸï¼<br>è®¢å•å·ï¼š${orderId}<br>é‡‘é¢ï¼šÂ¥${finalPrice}<br>çŠ¶æ€ï¼šå¾…å®¡æ ¸<br>ä»˜æ¬¾çŠ¶æ€ï¼šâœ… å·²æ ¸éªŒ`;
            document.getElementById("checkAllOrder").innerHTML=`âœ… å¾…å®¡æ ¸è®¢å•ï¼š${orderId} | Â¥${finalPrice}`;
            saveData();alert(`âœ… è®¢å•å·ï¼š${orderId}\nå·²é€šçŸ¥ç®¡ç†å‘˜å®¡æ ¸ï¼`);
        }
        function checkPayOk(){
            payCheckStatus = "ok";
            document.getElementById("payStatus").className = "status-tag status-ok";
            document.getElementById("payStatus").innerText = "âœ… ä»˜æ¬¾æ ¸éªŒæœ‰æ•ˆï¼ŒçœŸå®ä»˜æ¬¾";
            document.getElementById("checkAllOrder").innerHTML = `âœ… ä»˜æ¬¾æœ‰æ•ˆ | Â¥${finalPrice} | å¯å®¡æ ¸è®¢å•`;
            alert("âœ… ä»˜æ¬¾æ ¸éªŒæˆåŠŸï¼");saveData();
        }
        function agreeOrder(){
            if(payCheckStatus !== "ok"){alert("âš ï¸ è¯·å…ˆæ ¸éªŒä»˜æ¬¾çœŸå®æ€§ï¼");return;}
            const order = window.orderList[window.orderList.length-1];
            if(!order)return;order.orderStatus = "å·²åŒæ„";
            if(selectedPlayId !== "auto"){
                const targetPlay = window.playList.find(item=>item.pwd===selectedPlayId);
                if(targetPlay){
                    targetPlay.orderStatus = "working";
                    document.getElementById("orderList").innerHTML=`âœ… æœ‰æ•ˆè®¢å•ï¼š${order.id} | Â¥${order.price}`;
                    alert(`âœ… è®¢å•å®¡æ ¸é€šè¿‡ï¼ã€${targetPlay.name}ã€‘å·²æ¥å•`);
                    targetPlay.money += finalPrice;
                }
            }else{
                autoDispatchOrder(order);
            }
            saveData();initFloatList();getAdminData();
        }
        function reportProgress(){
            const num = document.getElementById("progressNum").value;
            if(!num)alert("âš ï¸ è¾“å…¥å®Œæˆå±€æ•°ï¼");
            else{
                const play=window.playList.find(item=>item.pwd===currentPlayId);
                play.orderStatus = "å¾…è€æ¿è¯„ä»·ç»“å•";
                initFloatList();saveData();
                document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-other">é™ªç©ï¼šå·²å®Œæˆ${num}å±€ï¼Œè¯·è€æ¿ç¡®è®¤ç»“å•å¹¶è¯„ä»·</div>`;
                alert(`âœ… å‘èµ·ç»“å•æˆåŠŸï¼\nå®Œæˆ${num}å±€ï¼Œç­‰å¾…è€æ¿ç¡®è®¤+ç®¡ç†å‘˜ç»ˆå®¡`);
            }
        }
        function giveScore(type){
            if(selectedPlayId==="auto"){alert("âš ï¸ è¯·å…ˆæŒ‡å®šé™ªç©ï¼");return;}
            const play=window.playList.find(item=>item.pwd===selectedPlayId);
            if(type==="good"){play.good++;}
            if(type==="bad"){play.bad++;}
            if(type==="complain"){if(confirm("âš ï¸ æŠ•è¯‰+1å…ƒï¼Œç¡®è®¤ï¼Ÿ")){play.bad++;finalPrice +=1;}}
            
            play.orderStatus = "å¾…ç®¡ç†å‘˜æœ€ç»ˆç¡®è®¤ç»“å•";
            document.getElementById("bossChat").innerHTML += `<div class="chat-msg msg-me">è€æ¿ï¼šå·²${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰'}ï¼Œç­‰å¾…ç®¡ç†å‘˜ç»ˆå®¡ç»“å•</div>`;
            document.getElementById("adminChat").innerHTML += `<div class="chat-msg msg-other">è€æ¿ï¼šè®¢å•${window.orderList[window.orderList.length-1].id}ï¼Œ${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰+1å…ƒ'}</div>`;
            saveData();initFloatList();
            alert(`âœ… ${type==='good'?'å¥½è¯„':type==='bad'?'å·®è¯„':'æŠ•è¯‰'}æäº¤æˆåŠŸï¼å·²å‘èµ·ç®¡ç†å‘˜ç»ˆå®¡`);
        }
        function changeStatus(status){
            const play=window.playList.find(item=>item.pwd===currentPlayId);
            play.status=status;document.getElementById("playStatus").innerText=status==="online"?"åœ¨çº¿":"ç¦»çº¿";
            document.getElementById("playStatus").className=status==="online"?"tip-green":"tip";
            initFloatList();saveData();alert(`âœ… å·²åˆ‡æ¢ä¸º${status}çŠ¶æ€ï¼`);
        }
        function getAdminData(){
            document.getElementById("todayMoney").innerText=Math.floor(Math.random()*2000);
            document.getElementById("todayOrder").innerText=window.orderList.length;
            const onlineNum = window.playList.filter(item=>item.status==="online").length;
            const idleNum = window.playList.filter(item=>item.status==="online" && item.orderStatus==="idle").length;
            document.getElementById("activePlay").innerText=onlineNum;
            document.getElementById("idlePlay").innerText=idleNum;
        }
        function updateActivityShow(){
            document.getElementById("activityName").innerText=activityName;
            document.getElementById("activePrice").innerText=activePrice;
            document.getElementById("activityStatus").innerText=isActivityOpen?"âœ… æ´»åŠ¨å·²å¼€å¯":"âŒ æ´»åŠ¨å·²å…³é—­";
            document.getElementById("activityStatus").className=isActivityOpen?"status-tag status-ok":"status-tag status-no";
            calcPrice();
        }
        function saveActivity(){
            activityName = document.getElementById("activityInput").value.trim();
            activePrice = document.getElementById("team4PriceInput").value || 2;
            isActivityOpen = true;updateActivityShow();saveData();alert("âœ… æ´»åŠ¨é…ç½®ä¿å­˜æˆåŠŸï¼");
        }
        function closeActivity(){isActivityOpen = false;updateActivityShow();calcPrice();saveData();alert("âœ… æ´»åŠ¨å·²å…³é—­ï¼Œæ¢å¤åŸä»·ï¼");}
        function openPlayLogin(){document.getElementById("playLoginModal").style.display="flex";}
        function openAdminLogin(){document.getElementById("adminLoginModal").style.display="flex";}
        function playLogin() {
            const pwd = document.getElementById("playPwd").value.trim();
            const play = window.playList.find(item=>item.pwd===pwd);
            if(!play){alert("å¯†ç é”™è¯¯ï¼");return;}
            if(play.deviceId && play.deviceId!==window.deviceId){alert("è´¦å·å·²åœ¨å…¶ä»–è®¾å¤‡ç™»å½•ï¼");return;}
            isPlayLogin=true;currentPlayId=pwd;document.getElementById("playLoginModal").style.display="none";switchTab("play");playBindCheck();
        }
        function adminLogin() {
            const pwd = document.getElementById("adminPwd").value.trim();
            if(pwd!==window.adminPwd){alert("å¯†ç é”™è¯¯ï¼");return;}
            isAdminLogin=true;document.getElementById("adminLoginModal").style.display="none";switchTab("admin");
        }
        function bossBindPhone() {
            const phone = document.getElementById("bossPhone").value.trim();
            if(!/^1[3-9]\d{9}$/.test(phone)){alert("æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼");return;}
            window.bossInfo = {phone,deviceId:window.deviceId};
            document.getElementById("bossBindBox").style.display="none";
            document.getElementById("bossBindSuccess").style.display="block";
            document.getElementById("bossBindedPhone").innerText=phone;
            isBossBind=true;saveData();alert("âœ… è€æ¿ç»‘å®šæˆåŠŸï¼");
        }
        function bossBindCheck(){if(window.bossInfo.phone&&window.bossInfo.deviceId===window.deviceId){isBossBind=true;document.getElementById("bossBindBox").style.display="none";document.getElementById("bossBindSuccess").style.display="block";document.getElementById("bossBindedPhone").innerText=window.bossInfo.phone;}}
        function bossUnbind(){window.bossInfo={phone:"",deviceId:""};document.getElementById("bossBindBox").style.display="block";document.getElementById("bossBindSuccess").style.display="none";saveData();}
        function playBindPhone() {
            const phone = document.getElementById("playPhone").value.trim();
            if(!/^1[3-9]\d{9}$/.test(phone)){alert("æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼");return;}
            const play=window.playList.find(item=>item.pwd===currentPlayId);
            play.phone=phone;play.deviceId=window.deviceId;
            document.getElementById("playBindBox").style.display="none";document.getElementById("playBindSuccess").style.display="block";document.getElementById("playBindedPhone").innerText=phone;
            saveData();alert("âœ… é™ªç©ç»‘å®šæˆåŠŸï¼Œå…å¯†ç™»å½•ï¼");
        }
        function playBindCheck(){const play=window.playList.find(item=>item.pwd===currentPlayId);if(play&&play.phone){document.getElementById("playBindBox").style.display="none";document.getElementById("playBindSuccess").style.display="block";document.getElementById("playBindedPhone").innerText=play.phone;}}
        function playUnbind(){const play=window.playList.find(item=>item.pwd===currentPlayId);play.phone="";play.deviceId="";document.getElementById("playBindBox").style.display="block";document.getElementById("playBindSuccess").style.display="none";saveData();}
        function switchTab(tab){
            if(tab==="play"&&!isPlayLogin){openPlayLogin();return;}if(tab==="admin"&&!isAdminLogin){openAdminLogin();return;}
            currentTab=tab;document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
            document.querySelector(`.tab-btn[onclick="${tab==='boss'?'switchTab(\'boss\')':tab==='play'?'openPlayLogin()':'openAdminLogin()'}"]`).classList.add('active');
            document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(tab).classList.add('active');
        }
        function changeAdminPwd(){const pwd=document.getElementById("newAdminPwd").value.trim();if(!pwd)alert("âš ï¸ è¾“å…¥æ–°å¯†ç ï¼");else{window.adminPwd=pwd;saveData();alert("âœ… å¯†ç ä¿®æ”¹æˆåŠŸï¼");document.getElementById("newAdminPwd").value="";}}
        function getOrder(){document.getElementById("orderList").innerHTML=window.orderList.length>0&&window.orderList[window.orderList.length-1].orderStatus==="å·²åŒæ„"?`âœ… è®¢å•ï¼š${window.orderList[window.orderList.length-1].id}`:"æš‚æ— æœ‰æ•ˆè®¢å•";}
        function saveCode(){alert("âœ… æ”¶æ¬¾ç ä¿å­˜æˆåŠŸï¼");}

        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.onload = ()=>{loadData();calcPrice();initFloatList();};
    </script>
</body>
</html>
